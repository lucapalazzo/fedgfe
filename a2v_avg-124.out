Wed Jan 21 03:18:39 PM UTC 2026
_CudaDeviceProperties(name='NVIDIA H100 80GB HBM3', major=9, minor=0, total_memory=81089MB, multi_processor_count=132, uuid=f5c8c5e2-c151-ad95-9de2-94cf335f37fb, L2_cache_size=50MB)
0 0

Applied default for experiment.goal: test
Applied default for experiment.device: cuda
Applied default for experiment.device_id: 0
Applied default for experiment.runs: 1
Applied default for experiment.seed: -1
Applied default for experiment.optimize_memory: False
Applied default for experiment.debug: False
Applied default for federation.join_ratio: 1.0
Applied default for federation.generate_images_frequency: 0
Applied default for model.num_classes: 10
Applied default for model.embedding_size: 768
Applied default for model.patch_size: 16
Applied default for training.momentum: 0.9
Applied default for training.learning_rate_schedule: False
Applied default for dataset.image_size: -1
Applied default for dataset.transform: False
Applied default for dataset.partition: pat
Applied default for dataset.dir_alpha: 0.1
Applied default for dataset.balance: False
Applied default for rewind.epochs: 0
Applied default for rewind.ratio: 0.0
Applied default for rewind.interval: 0
Applied default for rewind.strategy: none
Applied default for fedgfe.nodes_datasets: cifar10
Applied default for fedgfe.nodes_downstream_tasks: none
Applied default for fedgfe.nodes_pretext_tasks: 
Applied default for fedgfe.nodes_training_sequence: both
Applied default for fedgfe.cls_token_only: False
Applied default for fedgfe.limit_samples_number: 0
Applied default for feda2v.diffusion_type: sd
Applied default for feda2v.use_act_loss: False
Applied default for feda2v.use_text_loss: True
Applied default for feda2v.use_image_loss: False
Applied default for feda2v.audio_model_name: MIT/ast-finetuned-audioset-10-10-0.4593
Applied default for feda2v.image_model_name: google/vit-base-patch16-224-in21k
Applied default for feda2v.img_pipe_name: runwayml/stable-diffusion-v1-5
Applied default for feda2v.img_lcm_lora_id: latent-consistency/lcm-lora-sdv1-5
Applied default for feda2v.audio_pipe_name: cvssp/audioldm-l-full
Applied default for feda2v.steps: 1000
Applied default for feda2v.mode: train_nodata
Applied default for feda2v.ablation_type: only_t5
Applied default for feda2v.controllability_type: volume
Applied default for feda2v.target_img_path: data/img
Applied default for feda2v.img_out_path: exp/img
Applied default for feda2v.audio_out_path: exp/audio
Applied default for feda2v.class_to_activate: 8
Applied default for feda2v.single_class: False
Applied default for feda2v.checkpoint_name: best_model
Applied default for feda2v.project: sinestesia
Applied default for feda2v.entity: ctlab-team
Applied default for feda2v.wandb_mode: offline
Applied default for feda2v.global_model_train_from_generator: False
Applied default for feda2v.global_model_train_from_nodes_audio_embeddings: False
Applied default for feda2v.global_model_train_inputs: none
Applied default for feda2v.adapter_aggregation_method: none
Applied default for feda2v.text_losses_summed: False
Applied default for feda2v.compute_global_mean_from_class_means: False
Applied default for feda2v.generation_split_for_metrics: ['test', 'val']
Applied default for feda2v.synthetic_samples_per_class: auto
Applied default for feda2v.reset_generator_on_class_change: True
Applied default for feda2v.shared_generator_in_only_mode: True
Applied default for nodes.0.dataset_split: all
Applied default for nodes.0.pretext_tasks: []
Applied default for nodes.0.task_type: classification
Applied default for nodes.0.balance_classes: False
Applied default for nodes.0.use_folds: False
Applied default for nodes.0.train_folds: [0, 1, 2, 3]
Applied default for nodes.0.test_folds: [4]
Applied default for nodes.1.dataset_split: all
Applied default for nodes.1.pretext_tasks: []
Applied default for nodes.1.task_type: classification
Applied default for nodes.1.balance_classes: False
Applied default for nodes.1.use_folds: False
Applied default for nodes.1.train_folds: [0, 1, 2, 3]
Applied default for nodes.1.test_folds: [4]
Warning: Could not map class label 'dog' to numeric index
Node 0: Selected classes ['dog'] -> []
Warning: Could not map class label 'chainsaw' to numeric index
Node 1: Selected classes ['chainsaw'] -> []
Set num_clients: 2
Successfully loaded configuration from: configs/a2v_vegas_2n_2c_200s_avg.json
Using nodes_tasks from config file (already processed)
==================================================
Algorithm: FedA2V
Local batch size: 8
Local epochs: 10
Local learing rate: 0.001
Local learing rate schedule: False
Total number of clients: 2
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: VEGAS
Number of classes: 10
Backbone: a2v
Using device: cuda
Using DP: False
Auto break: False
Global rounds: 20
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
A2V G model sd

============= Running time: 0th =============
Creating server and clients ...
None
Enabling wandb to progect:  FedA2V
Finished creating server and clients.
2026-01-21 15:18:52,665 - utils.ballooning - INFO - Initialized GPUMemoryBalloon for GPU 0
2026-01-21 15:18:52,901 - utils.ballooning - INFO - GPU 0: Total memory: 81089 MB, Free before: 80563 MB, Target reserve: 0 MB
2026-01-21 15:18:52,902 - utils.ballooning - INFO - GPU 0: Successfully allocated 0 MB. Free memory: 80563 MB -> 80563 MB
2026-01-21 15:18:54,427 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - Initializing AST model: MIT/ast-finetuned-audioset-10-10-0.4593
2026-01-21 15:18:55,076 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - AST model initialized successfully
Started diffusion model flux
Creating 0 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['dog']
2026-01-21 15:18:59,967 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-21 15:18:59,967 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-21 15:19:00,156 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:00,156 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:00,332 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:00,333 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:00,336 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 160 samples, classes: ['dog'], split: train
2026-01-21 15:19:00,336 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-21 15:19:00,522 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:00,522 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:00,698 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:00,698 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:00,701 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['dog'], split: val
2026-01-21 15:19:00,701 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-21 15:19:00,885 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:00,885 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:01,060 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:01,061 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:01,063 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['dog'], split: test
2026-01-21 15:19:01,063 - datautils.dataset_vegas - INFO - Auto-split created: train=160, val=20, test=20
2026-01-21 15:19:01,238 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:01,239 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:01,416 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 15:19:01,416 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:01,418 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['dog'], split: None
Stratified split: train=160, val=20, test=20
Trying to set schdulers but no optimizer for client  0
2026-01-21 15:19:03,581 - flcore.clients.clientA2V - INFO - Node 0: Using global use_cls_token_only=False
2026-01-21 15:19:04,536 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-21 15:19:04,537 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-21 15:19:04,537 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=160, val=20, test=20
[Client 0] Auto-calculated synthetic_samples_per_class = 160 (total samples: 160, classes: 1)
Creating 1 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['chainsaw']
2026-01-21 15:19:08,822 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-21 15:19:08,822 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-21 15:19:08,948 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:08,948 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,066 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:09,067 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,070 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 160 samples, classes: ['chainsaw'], split: train
2026-01-21 15:19:09,070 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-21 15:19:09,196 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:09,197 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,315 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:09,315 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,318 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['chainsaw'], split: val
2026-01-21 15:19:09,318 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-21 15:19:09,445 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:09,445 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,563 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:09,564 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,566 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['chainsaw'], split: test
2026-01-21 15:19:09,566 - datautils.dataset_vegas - INFO - Auto-split created: train=160, val=20, test=20
2026-01-21 15:19:09,682 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:09,682 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,798 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 15:19:09,799 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 15:19:09,800 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['chainsaw'], split: None
Stratified split: train=160, val=20, test=20
Trying to set schdulers but no optimizer for client  1
2026-01-21 15:19:11,813 - flcore.clients.clientA2V - INFO - Node 1: Using global use_cls_token_only=False
2026-01-21 15:19:12,796 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-21 15:19:12,797 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-21 15:19:12,797 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=160, val=20, test=20
[Client 1] Auto-calculated synthetic_samples_per_class = 160 (total samples: 160, classes: 1)
Created server test dataset with 40 samples from 2 nodes
2026-01-21 15:19:17,108 - flcore.servers.serverA2V - INFO - [Server] Auto-calculating synthetic_samples_per_class for each node and class
2026-01-21 15:19:17,108 - flcore.servers.serverA2V - INFO - [Server] Node 0: 160 synthetic samples/class (total samples: 160, classes: 1)
2026-01-21 15:19:17,108 - flcore.servers.serverA2V - INFO - [Server] Node 1: 160 synthetic samples/class (total samples: 160, classes: 1)
2026-01-21 15:19:17,108 - flcore.servers.serverA2V - INFO - [Server] Average synthetic_samples_per_class = 160

*** Client 0 dataset VEGAS
2026-01-21 15:19:17,108 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.

*** Client 1 dataset VEGAS
2026-01-21 15:19:17,108 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.
2026-01-21 15:19:17,110 - flcore.servers.serverA2V - INFO - Finished creating Audio2Visual server and clients.

-------------Round number: 1-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 15:19:17,376 - flcore.servers.serverA2V - WARNING - === Round 1 starting hook temporally disabled ===
2026-01-21 15:19:17,640 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 15:19:18,834 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Creating dataloader for train dataset for client 0 with 160 samples
Creating dataloader for test dataset for client 0 with 20 samples
Creating optimizer for node 0 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 0
Node 0: No optimizer initialized
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 0] ‚ö†Ô∏è  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

üìä MEMORY SUMMARY:
  Start:  Allocated=2.97 GB, Reserved=3.11 GB (3.9%)
  End:    Allocated=5.79 GB, Reserved=7.32 GB (9.2%)
  Growth: Allocated=+2.816 GB, Reserved=+4.209 GB

üìà PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Œî Alloc         Œî Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.8714
2          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.2475
3          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0610
4          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0178
5          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0146
6          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0137
7          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0133
8          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0130
9          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0128
10         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0127

  üî¥ Max growth at Epoch 1: +4.209 GB reserved
====================================================================================================


Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Creating dataloader for train dataset for client 1 with 160 samples
Creating dataloader for test dataset for client 1 with 20 samples
Creating optimizer for node 1 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 1
Node 1: No optimizer initialized
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 1] ‚ö†Ô∏è  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

üìä MEMORY SUMMARY:
  Start:  Allocated=2.47 GB, Reserved=2.56 GB (3.2%)
  End:    Allocated=5.22 GB, Reserved=6.81 GB (8.6%)
  Growth: Allocated=+2.755 GB, Reserved=+4.258 GB

üìà PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Œî Alloc         Œî Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.9515
2          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.3300
3          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0927
4          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0213
5          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0163
6          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0151
7          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0146
8          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0143
9          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0141
10         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0140

  üî¥ Max growth at Epoch 1: +4.258 GB reserved
====================================================================================================


Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 1 time:  276.8578178882599
2026-01-21 15:23:54,667 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 15:23:54,773 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0063
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 0 metrics: test on val accuracy 0.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0070
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.055556 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.033333 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 1 metrics: test on val accuracy 0.2000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 15:26:01,781 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 1 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.015873 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.008333 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.015873015873015872, 'precision': 0.16666666666666666, 'recall': 0.008333333333333333, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.015873015873015872, 'std': 0.0, 'min': 0.015873015873015872, 'max': 0.015873015873015872, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.16666666666666666, 'std': 0.0, 'min': 0.16666666666666666, 'max': 0.16666666666666666, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.008333333333333333, 'std': 0.0, 'min': 0.008333333333333333, 'max': 0.008333333333333333, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 2-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 15:27:32,737 - flcore.servers.serverA2V - WARNING - === Round 2 starting hook temporally disabled ===
2026-01-21 15:27:32,741 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 15:27:34,152 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 2 time:  209.50852251052856
2026-01-21 15:31:02,562 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 15:31:02,658 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0 metrics: test on val accuracy 0.2500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 15:32:57,222 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 2 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.013605 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.007143 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.013605442176870748, 'precision': 0.14285714285714285, 'recall': 0.0071428571428571435, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.013605442176870748, 'std': 0.0, 'min': 0.013605442176870748, 'max': 0.013605442176870748, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0071428571428571435, 'std': 0.0, 'min': 0.0071428571428571435, 'max': 0.0071428571428571435, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.066592 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.197917 at index 0)
task recall: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score_weighted: 0.27 (std: 0.00, min: 0.27 at index 0, max: 0.266369 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.2, 'balanced_accuracy': 0.19999999999999998, 'f1_score': 0.0665922619047619, 'precision': 0.19791666666666669, 'recall': 0.049999999999999996, 'f1_score_weighted': 0.2663690476190476}), 'accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.19999999999999998, 'std': 0.0, 'min': 0.19999999999999998, 'max': 0.19999999999999998, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0665922619047619, 'std': 0.0, 'min': 0.0665922619047619, 'max': 0.0665922619047619, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.19791666666666669, 'std': 0.0, 'min': 0.19791666666666669, 'max': 0.19791666666666669, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.049999999999999996, 'std': 0.0, 'min': 0.049999999999999996, 'max': 0.049999999999999996, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2663690476190476, 'std': 0.0, 'min': 0.2663690476190476, 'max': 0.2663690476190476, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 3-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 15:34:19,110 - flcore.servers.serverA2V - WARNING - === Round 3 starting hook temporally disabled ===
2026-01-21 15:34:19,114 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 15:34:20,440 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 3 time:  245.32088899612427
2026-01-21 15:38:24,580 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 15:38:24,676 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037267 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.021429 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0 metrics: test on val accuracy 0.1500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1 metrics: test on val accuracy 0.9000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 15:40:11,818 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 3 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task balanced_accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task f1_score: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.101382 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.078571 at index 0)
task f1_score_weighted: 0.71 (std: 0.00, min: 0.71 at index 0, max: 0.709677 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.55, 'balanced_accuracy': 0.55, 'f1_score': 0.10138248847926268, 'precision': 0.14285714285714285, 'recall': 0.07857142857142858, 'f1_score_weighted': 0.7096774193548387}), 'accuracy': {'mean': 0.55, 'std': 0.0, 'min': 0.55, 'max': 0.55, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.55, 'std': 0.0, 'min': 0.55, 'max': 0.55, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.10138248847926268, 'std': 0.0, 'min': 0.10138248847926268, 'max': 0.10138248847926268, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.07857142857142858, 'std': 0.0, 'min': 0.07857142857142858, 'max': 0.07857142857142858, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.7096774193548387, 'std': 0.0, 'min': 0.7096774193548387, 'max': 0.7096774193548387, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.044444 at index 0)
task precision: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.066667 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.033333 at index 0)
task f1_score_weighted: 0.13 (std: 0.00, min: 0.13 at index 0, max: 0.133333 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.044444444444444446, 'precision': 0.06666666666666667, 'recall': 0.03333333333333333, 'f1_score_weighted': 0.13333333333333333}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.044444444444444446, 'std': 0.0, 'min': 0.044444444444444446, 'max': 0.044444444444444446, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.06666666666666667, 'std': 0.0, 'min': 0.06666666666666667, 'max': 0.06666666666666667, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03333333333333333, 'std': 0.0, 'min': 0.03333333333333333, 'max': 0.03333333333333333, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.13333333333333333, 'std': 0.0, 'min': 0.13333333333333333, 'max': 0.13333333333333333, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 4-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 15:41:24,769 - flcore.servers.serverA2V - WARNING - === Round 4 starting hook temporally disabled ===
2026-01-21 15:41:24,773 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 15:41:26,050 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 4 time:  214.16051816940308
2026-01-21 15:44:59,087 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 15:44:59,183 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.032609 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.018750 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0 metrics: test on val accuracy 0.1500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1 metrics: test on val accuracy 0.9000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 15:46:53,433 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 4 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025974 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.014286 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.025974025974025976, 'precision': 0.14285714285714285, 'recall': 0.014285714285714287, 'f1_score_weighted': 0.18181818181818182}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.025974025974025976, 'std': 0.0, 'min': 0.025974025974025976, 'max': 0.025974025974025976, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.014285714285714287, 'std': 0.0, 'min': 0.014285714285714287, 'max': 0.014285714285714287, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.18181818181818182, 'std': 0.0, 'min': 0.18181818181818182, 'max': 0.18181818181818182, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task balanced_accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035842 at index 0)
task precision: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050505 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.027778 at index 0)
task f1_score_weighted: 0.16 (std: 0.00, min: 0.16 at index 0, max: 0.161290 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.125, 'balanced_accuracy': 0.125, 'f1_score': 0.035842293906810034, 'precision': 0.050505050505050504, 'recall': 0.027777777777777776, 'f1_score_weighted': 0.16129032258064516}), 'accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.035842293906810034, 'std': 0.0, 'min': 0.035842293906810034, 'max': 0.035842293906810034, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.050505050505050504, 'std': 0.0, 'min': 0.050505050505050504, 'max': 0.050505050505050504, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.027777777777777776, 'std': 0.0, 'min': 0.027777777777777776, 'max': 0.027777777777777776, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.16129032258064516, 'std': 0.0, 'min': 0.16129032258064516, 'max': 0.16129032258064516, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 5-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 15:48:11,678 - flcore.servers.serverA2V - WARNING - === Round 5 starting hook temporally disabled ===
2026-01-21 15:48:11,681 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 15:48:13,159 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 5 time:  246.0576364994049
2026-01-21 15:52:18,375 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 15:52:18,472 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037267 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.021429 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0 metrics: test on val accuracy 0.1500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 15:54:22,317 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 5 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task balanced_accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.064815 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.043750 at index 0)
task f1_score_weighted: 0.52 (std: 0.00, min: 0.52 at index 0, max: 0.518519 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.35, 'balanced_accuracy': 0.35, 'f1_score': 0.06481481481481481, 'precision': 0.125, 'recall': 0.04375, 'f1_score_weighted': 0.5185185185185185}), 'accuracy': {'mean': 0.35, 'std': 0.0, 'min': 0.35, 'max': 0.35, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.35, 'std': 0.0, 'min': 0.35, 'max': 0.35, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.06481481481481481, 'std': 0.0, 'min': 0.06481481481481481, 'max': 0.06481481481481481, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.04375, 'std': 0.0, 'min': 0.04375, 'max': 0.04375, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.5185185185185185, 'std': 0.0, 'min': 0.5185185185185185, 'max': 0.5185185185185185, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.9, 'balanced_accuracy': 0.9, 'f1_score': 0.3157894736842105, 'precision': 0.3333333333333333, 'recall': 0.3, 'f1_score_weighted': 0.9473684210526315}), 'accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.3157894736842105, 'std': 0.0, 'min': 0.3157894736842105, 'max': 0.3157894736842105, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9473684210526315, 'std': 0.0, 'min': 0.9473684210526315, 'max': 0.9473684210526315, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.175000 at index 0)
task balanced_accuracy: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.175000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.048611 at index 0)
task precision: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.054688 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.043750 at index 0)
task f1_score_weighted: 0.19 (std: 0.00, min: 0.19 at index 0, max: 0.194444 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.175, 'balanced_accuracy': 0.175, 'f1_score': 0.04861111111111111, 'precision': 0.0546875, 'recall': 0.04375, 'f1_score_weighted': 0.19444444444444445}), 'accuracy': {'mean': 0.175, 'std': 0.0, 'min': 0.175, 'max': 0.175, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.175, 'std': 0.0, 'min': 0.175, 'max': 0.175, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.04861111111111111, 'std': 0.0, 'min': 0.04861111111111111, 'max': 0.04861111111111111, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0546875, 'std': 0.0, 'min': 0.0546875, 'max': 0.0546875, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.04375, 'std': 0.0, 'min': 0.04375, 'max': 0.04375, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.19444444444444445, 'std': 0.0, 'min': 0.19444444444444445, 'max': 0.19444444444444445, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 6-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 15:55:40,049 - flcore.servers.serverA2V - WARNING - === Round 6 starting hook temporally disabled ===
2026-01-21 15:55:40,053 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 15:55:41,140 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 6 time:  231.51290941238403
2026-01-21 15:59:32,139 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 15:59:32,241 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0 metrics: test on val accuracy 0.2500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:01:42,433 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 6 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.011905 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.006250 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.011904761904761904, 'precision': 0.125, 'recall': 0.00625, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.011904761904761904, 'std': 0.0, 'min': 0.011904761904761904, 'max': 0.011904761904761904, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.00625, 'std': 0.0, 'min': 0.00625, 'max': 0.00625, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task balanced_accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.041847 at index 0)
task precision: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.111111 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.027778 at index 0)
task f1_score_weighted: 0.19 (std: 0.00, min: 0.19 at index 0, max: 0.188312 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.125, 'balanced_accuracy': 0.125, 'f1_score': 0.04184704184704185, 'precision': 0.1111111111111111, 'recall': 0.027777777777777776, 'f1_score_weighted': 0.1883116883116883}), 'accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.04184704184704185, 'std': 0.0, 'min': 0.04184704184704185, 'max': 0.04184704184704185, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.1111111111111111, 'std': 0.0, 'min': 0.1111111111111111, 'max': 0.1111111111111111, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.027777777777777776, 'std': 0.0, 'min': 0.027777777777777776, 'max': 0.027777777777777776, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.1883116883116883, 'std': 0.0, 'min': 0.1883116883116883, 'max': 0.1883116883116883, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 7-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:02:59,912 - flcore.servers.serverA2V - WARNING - === Round 7 starting hook temporally disabled ===
2026-01-21 16:02:59,915 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:03:01,115 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 7 time:  216.19488072395325
2026-01-21 16:06:36,815 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:06:36,909 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.028571 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0 metrics: test on val accuracy 0.2000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:08:45,757 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 7 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.028986 at index 0)
task precision: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.111111 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.016667 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.15, 'balanced_accuracy': 0.15, 'f1_score': 0.028985507246376812, 'precision': 0.1111111111111111, 'recall': 0.016666666666666666, 'f1_score_weighted': 0.2608695652173913}), 'accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.028985507246376812, 'std': 0.0, 'min': 0.028985507246376812, 'max': 0.028985507246376812, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.1111111111111111, 'std': 0.0, 'min': 0.1111111111111111, 'max': 0.1111111111111111, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.016666666666666666, 'std': 0.0, 'min': 0.016666666666666666, 'max': 0.016666666666666666, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2608695652173913, 'std': 0.0, 'min': 0.2608695652173913, 'max': 0.2608695652173913, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.034483 at index 0)
task precision: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.055556 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score_weighted: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.137931 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.034482758620689655, 'precision': 0.05555555555555555, 'recall': 0.025, 'f1_score_weighted': 0.13793103448275862}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.034482758620689655, 'std': 0.0, 'min': 0.034482758620689655, 'max': 0.034482758620689655, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.05555555555555555, 'std': 0.0, 'min': 0.05555555555555555, 'max': 0.05555555555555555, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.13793103448275862, 'std': 0.0, 'min': 0.13793103448275862, 'max': 0.13793103448275862, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 8-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:10:09,108 - flcore.servers.serverA2V - WARNING - === Round 8 starting hook temporally disabled ===
2026-01-21 16:10:09,112 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:10:10,396 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 8 time:  224.06906461715698
2026-01-21 16:13:53,811 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:13:53,911 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.028571 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0 metrics: test on val accuracy 0.2000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:15:51,920 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 8 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037267 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.021429 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.15, 'balanced_accuracy': 0.15, 'f1_score': 0.037267080745341616, 'precision': 0.14285714285714285, 'recall': 0.02142857142857143, 'f1_score_weighted': 0.2608695652173913}), 'accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.037267080745341616, 'std': 0.0, 'min': 0.037267080745341616, 'max': 0.037267080745341616, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.02142857142857143, 'std': 0.0, 'min': 0.02142857142857143, 'max': 0.02142857142857143, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2608695652173913, 'std': 0.0, 'min': 0.2608695652173913, 'max': 0.2608695652173913, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.071429 at index 0)
task precision: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.083333 at index 0)
task recall: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.062500 at index 0)
task f1_score_weighted: 0.29 (std: 0.00, min: 0.29 at index 0, max: 0.285714 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.07142857142857142, 'precision': 0.08333333333333333, 'recall': 0.0625, 'f1_score_weighted': 0.2857142857142857}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.07142857142857142, 'std': 0.0, 'min': 0.07142857142857142, 'max': 0.07142857142857142, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.08333333333333333, 'std': 0.0, 'min': 0.08333333333333333, 'max': 0.08333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0625, 'std': 0.0, 'min': 0.0625, 'max': 0.0625, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2857142857142857, 'std': 0.0, 'min': 0.2857142857142857, 'max': 0.2857142857142857, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 9-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:17:06,524 - flcore.servers.serverA2V - WARNING - === Round 9 starting hook temporally disabled ===
2026-01-21 16:17:06,527 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:17:07,607 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 9 time:  236.16731023788452
2026-01-21 16:21:03,435 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:21:03,533 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.043478 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.025000 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0 metrics: test on val accuracy 0.1500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.473684 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.45 (std: 0.00, min: 0.45 at index 0, max: 0.450000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1 metrics: test on val accuracy 0.9000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:23:04,280 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 9 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.45 (std: 0.00, min: 0.45 at index 0, max: 0.450000 at index 0)
task balanced_accuracy: 0.45 (std: 0.00, min: 0.45 at index 0, max: 0.450000 at index 0)
task f1_score: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.088670 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.064286 at index 0)
task f1_score_weighted: 0.62 (std: 0.00, min: 0.62 at index 0, max: 0.620690 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.45, 'balanced_accuracy': 0.45, 'f1_score': 0.08866995073891626, 'precision': 0.14285714285714285, 'recall': 0.0642857142857143, 'f1_score_weighted': 0.6206896551724138}), 'accuracy': {'mean': 0.45, 'std': 0.0, 'min': 0.45, 'max': 0.45, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.45, 'std': 0.0, 'min': 0.45, 'max': 0.45, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.08866995073891626, 'std': 0.0, 'min': 0.08866995073891626, 'max': 0.08866995073891626, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0642857142857143, 'std': 0.0, 'min': 0.0642857142857143, 'max': 0.0642857142857143, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.6206896551724138, 'std': 0.0, 'min': 0.6206896551724138, 'max': 0.6206896551724138, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task balanced_accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035842 at index 0)
task precision: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050505 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.027778 at index 0)
task f1_score_weighted: 0.16 (std: 0.00, min: 0.16 at index 0, max: 0.161290 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.125, 'balanced_accuracy': 0.125, 'f1_score': 0.035842293906810034, 'precision': 0.050505050505050504, 'recall': 0.027777777777777776, 'f1_score_weighted': 0.16129032258064516}), 'accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.035842293906810034, 'std': 0.0, 'min': 0.035842293906810034, 'max': 0.035842293906810034, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.050505050505050504, 'std': 0.0, 'min': 0.050505050505050504, 'max': 0.050505050505050504, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.027777777777777776, 'std': 0.0, 'min': 0.027777777777777776, 'max': 0.027777777777777776, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.16129032258064516, 'std': 0.0, 'min': 0.16129032258064516, 'max': 0.16129032258064516, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 10-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:24:19,923 - flcore.servers.serverA2V - WARNING - === Round 10 starting hook temporally disabled ===
2026-01-21 16:24:19,926 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:24:21,112 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 10 time:  248.21052765846252
2026-01-21 16:28:28,758 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:28:28,860 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.022727 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.012500 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0 metrics: test on val accuracy 0.1000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:30:30,136 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 10 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.45 (std: 0.00, min: 0.45 at index 0, max: 0.450000 at index 0)
task balanced_accuracy: 0.45 (std: 0.00, min: 0.45 at index 0, max: 0.450000 at index 0)
task f1_score: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.103448 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task f1_score_weighted: 0.62 (std: 0.00, min: 0.62 at index 0, max: 0.620690 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.45, 'balanced_accuracy': 0.45, 'f1_score': 0.10344827586206896, 'precision': 0.16666666666666666, 'recall': 0.075, 'f1_score_weighted': 0.6206896551724138}), 'accuracy': {'mean': 0.45, 'std': 0.0, 'min': 0.45, 'max': 0.45, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.45, 'std': 0.0, 'min': 0.45, 'max': 0.45, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.10344827586206896, 'std': 0.0, 'min': 0.10344827586206896, 'max': 0.10344827586206896, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.16666666666666666, 'std': 0.0, 'min': 0.16666666666666666, 'max': 0.16666666666666666, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.075, 'std': 0.0, 'min': 0.075, 'max': 0.075, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.6206896551724138, 'std': 0.0, 'min': 0.6206896551724138, 'max': 0.6206896551724138, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task balanced_accuracy: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.048237 at index 0)
task precision: 0.19 (std: 0.00, min: 0.19 at index 0, max: 0.186813 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.168831 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.125, 'balanced_accuracy': 0.125, 'f1_score': 0.04823747680890538, 'precision': 0.18681318681318682, 'recall': 0.03571428571428571, 'f1_score_weighted': 0.16883116883116883}), 'accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.04823747680890538, 'std': 0.0, 'min': 0.04823747680890538, 'max': 0.04823747680890538, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.18681318681318682, 'std': 0.0, 'min': 0.18681318681318682, 'max': 0.18681318681318682, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03571428571428571, 'std': 0.0, 'min': 0.03571428571428571, 'max': 0.03571428571428571, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.16883116883116883, 'std': 0.0, 'min': 0.16883116883116883, 'max': 0.16883116883116883, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 11-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:31:43,220 - flcore.servers.serverA2V - WARNING - === Round 11 starting hook temporally disabled ===
2026-01-21 16:31:43,224 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:31:44,068 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 11 time:  241.7169861793518
2026-01-21 16:35:45,543 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:35:45,640 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.022727 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.012500 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0 metrics: test on val accuracy 0.1000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1 metrics: test on val accuracy 0.9000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:37:49,962 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 11 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_11_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.065934 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.042857 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.3, 'balanced_accuracy': 0.3, 'f1_score': 0.06593406593406594, 'precision': 0.14285714285714285, 'recall': 0.04285714285714286, 'f1_score_weighted': 0.46153846153846156}), 'accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.06593406593406594, 'std': 0.0, 'min': 0.06593406593406594, 'max': 0.06593406593406594, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.04285714285714286, 'std': 0.0, 'min': 0.04285714285714286, 'max': 0.04285714285714286, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.46153846153846156, 'std': 0.0, 'min': 0.46153846153846156, 'max': 0.46153846153846156, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.071429 at index 0)
task precision: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)
task recall: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task f1_score_weighted: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.2, 'balanced_accuracy': 0.2, 'f1_score': 0.07142857142857142, 'precision': 0.09523809523809523, 'recall': 0.05714285714285715, 'f1_score_weighted': 0.25}), 'accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.07142857142857142, 'std': 0.0, 'min': 0.07142857142857142, 'max': 0.07142857142857142, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.05714285714285715, 'std': 0.0, 'min': 0.05714285714285715, 'max': 0.05714285714285715, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 12-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:39:03,966 - flcore.servers.serverA2V - WARNING - === Round 12 starting hook temporally disabled ===
2026-01-21 16:39:03,970 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:39:05,083 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 12 time:  234.32583665847778
2026-01-21 16:42:59,012 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:42:59,115 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0093
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.011905 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.006250 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0 metrics: test on val accuracy 0.0500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:45:06,115 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 12 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_12_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.013605 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.007143 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.013605442176870748, 'precision': 0.14285714285714285, 'recall': 0.0071428571428571435, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.013605442176870748, 'std': 0.0, 'min': 0.013605442176870748, 'max': 0.013605442176870748, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0071428571428571435, 'std': 0.0, 'min': 0.0071428571428571435, 'max': 0.0071428571428571435, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task balanced_accuracy: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.022989 at index 0)
task precision: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037037 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.016667 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.103448 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.075, 'balanced_accuracy': 0.075, 'f1_score': 0.022988505747126436, 'precision': 0.037037037037037035, 'recall': 0.016666666666666666, 'f1_score_weighted': 0.10344827586206898}), 'accuracy': {'mean': 0.075, 'std': 0.0, 'min': 0.075, 'max': 0.075, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.075, 'std': 0.0, 'min': 0.075, 'max': 0.075, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.022988505747126436, 'std': 0.0, 'min': 0.022988505747126436, 'max': 0.022988505747126436, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.037037037037037035, 'std': 0.0, 'min': 0.037037037037037035, 'max': 0.037037037037037035, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.016666666666666666, 'std': 0.0, 'min': 0.016666666666666666, 'max': 0.016666666666666666, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.10344827586206898, 'std': 0.0, 'min': 0.10344827586206898, 'max': 0.10344827586206898, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 13-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:46:28,694 - flcore.servers.serverA2V - WARNING - === Round 13 starting hook temporally disabled ===
2026-01-21 16:46:28,698 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:46:29,864 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 13 time:  233.34895491600037
2026-01-21 16:50:22,650 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:50:22,755 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0052
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.065934 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.042857 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 0 metrics: test on val accuracy 0.3000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0060
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.115385 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 1 metrics: test on val accuracy 0.3000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:52:30,640 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 13 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_13_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025974 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.014286 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.025974025974025976, 'precision': 0.14285714285714285, 'recall': 0.014285714285714287, 'f1_score_weighted': 0.18181818181818182}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.025974025974025976, 'std': 0.0, 'min': 0.025974025974025976, 'max': 0.025974025974025976, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.014285714285714287, 'std': 0.0, 'min': 0.014285714285714287, 'max': 0.014285714285714287, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.18181818181818182, 'std': 0.0, 'min': 0.18181818181818182, 'max': 0.18181818181818182, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.092308 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.060000 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.3, 'balanced_accuracy': 0.3, 'f1_score': 0.09230769230769231, 'precision': 0.2, 'recall': 0.06, 'f1_score_weighted': 0.46153846153846156}), 'accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.09230769230769231, 'std': 0.0, 'min': 0.09230769230769231, 'max': 0.09230769230769231, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.06, 'std': 0.0, 'min': 0.06, 'max': 0.06, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.46153846153846156, 'std': 0.0, 'min': 0.46153846153846156, 'max': 0.46153846153846156, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 14-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 16:53:54,149 - flcore.servers.serverA2V - WARNING - === Round 14 starting hook temporally disabled ===
2026-01-21 16:53:54,153 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 16:53:55,112 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 14 time:  233.24496722221375
2026-01-21 16:57:48,085 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 16:57:48,186 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0088
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.75 (std: 0.00, min: 0.75 at index 0, max: 0.750000 at index 0)
task balanced_accuracy: 0.75 (std: 0.00, min: 0.75 at index 0, max: 0.750000 at index 0)
task f1_score: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.171429 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score_weighted: 0.86 (std: 0.00, min: 0.86 at index 0, max: 0.857143 at index 0)

Node 0 metrics: test on val accuracy 0.7500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0062
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task balanced_accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task f1_score: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.141935 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.110000 at index 0)
task f1_score_weighted: 0.71 (std: 0.00, min: 0.71 at index 0, max: 0.709677 at index 0)

Node 1 metrics: test on val accuracy 0.5500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 16:59:57,435 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 14 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_14_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.65 (std: 0.00, min: 0.65 at index 0, max: 0.650000 at index 0)
task balanced_accuracy: 0.65 (std: 0.00, min: 0.65 at index 0, max: 0.650000 at index 0)
task f1_score: 0.16 (std: 0.00, min: 0.16 at index 0, max: 0.157576 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.13 (std: 0.00, min: 0.13 at index 0, max: 0.130000 at index 0)
task f1_score_weighted: 0.79 (std: 0.00, min: 0.79 at index 0, max: 0.787879 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.65, 'balanced_accuracy': 0.65, 'f1_score': 0.15757575757575756, 'precision': 0.2, 'recall': 0.13, 'f1_score_weighted': 0.7878787878787878}), 'accuracy': {'mean': 0.65, 'std': 0.0, 'min': 0.65, 'max': 0.65, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.65, 'std': 0.0, 'min': 0.65, 'max': 0.65, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.15757575757575756, 'std': 0.0, 'min': 0.15757575757575756, 'max': 0.15757575757575756, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.13, 'std': 0.0, 'min': 0.13, 'max': 0.13, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.7878787878787878, 'std': 0.0, 'min': 0.7878787878787878, 'max': 0.7878787878787878, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task balanced_accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task f1_score: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.114286 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.080000 at index 0)
task f1_score_weighted: 0.57 (std: 0.00, min: 0.57 at index 0, max: 0.571429 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.4, 'balanced_accuracy': 0.4, 'f1_score': 0.11428571428571428, 'precision': 0.2, 'recall': 0.08, 'f1_score_weighted': 0.5714285714285714}), 'accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.11428571428571428, 'std': 0.0, 'min': 0.11428571428571428, 'max': 0.11428571428571428, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.08, 'std': 0.0, 'min': 0.08, 'max': 0.08, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.5714285714285714, 'std': 0.0, 'min': 0.5714285714285714, 'max': 0.5714285714285714, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.175000 at index 0)
task balanced_accuracy: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.175000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047297 at index 0)
task precision: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.051471 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.043750 at index 0)
task f1_score_weighted: 0.19 (std: 0.00, min: 0.19 at index 0, max: 0.189189 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.175, 'balanced_accuracy': 0.175, 'f1_score': 0.0472972972972973, 'precision': 0.051470588235294115, 'recall': 0.04375, 'f1_score_weighted': 0.1891891891891892}), 'accuracy': {'mean': 0.175, 'std': 0.0, 'min': 0.175, 'max': 0.175, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.175, 'std': 0.0, 'min': 0.175, 'max': 0.175, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0472972972972973, 'std': 0.0, 'min': 0.0472972972972973, 'max': 0.0472972972972973, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.051470588235294115, 'std': 0.0, 'min': 0.051470588235294115, 'max': 0.051470588235294115, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.04375, 'std': 0.0, 'min': 0.04375, 'max': 0.04375, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.1891891891891892, 'std': 0.0, 'min': 0.1891891891891892, 'max': 0.1891891891891892, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 15-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 17:01:15,911 - flcore.servers.serverA2V - WARNING - === Round 15 starting hook temporally disabled ===
2026-01-21 17:01:15,914 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 17:01:16,921 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 15 time:  227.2628710269928
2026-01-21 17:05:03,799 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 17:05:03,897 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0050
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.031250 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0 metrics: test on val accuracy 0.2500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0038
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 17:07:05,221 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 15 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_15_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025974 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.014286 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.025974025974025976, 'precision': 0.14285714285714285, 'recall': 0.014285714285714287, 'f1_score_weighted': 0.18181818181818182}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.025974025974025976, 'std': 0.0, 'min': 0.025974025974025976, 'max': 0.025974025974025976, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.014285714285714287, 'std': 0.0, 'min': 0.014285714285714287, 'max': 0.014285714285714287, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.18181818181818182, 'std': 0.0, 'min': 0.18181818181818182, 'max': 0.18181818181818182, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.068376 at index 0)
task precision: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.070175 at index 0)
task recall: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.066667 at index 0)
task f1_score_weighted: 0.21 (std: 0.00, min: 0.21 at index 0, max: 0.205128 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.2, 'balanced_accuracy': 0.2, 'f1_score': 0.06837606837606837, 'precision': 0.07017543859649122, 'recall': 0.06666666666666667, 'f1_score_weighted': 0.20512820512820512}), 'accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.06837606837606837, 'std': 0.0, 'min': 0.06837606837606837, 'max': 0.06837606837606837, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.07017543859649122, 'std': 0.0, 'min': 0.07017543859649122, 'max': 0.07017543859649122, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.06666666666666667, 'std': 0.0, 'min': 0.06666666666666667, 'max': 0.06666666666666667, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.20512820512820512, 'std': 0.0, 'min': 0.20512820512820512, 'max': 0.20512820512820512, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 16-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 17:08:18,494 - flcore.servers.serverA2V - WARNING - === Round 16 starting hook temporally disabled ===
2026-01-21 17:08:18,498 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 17:08:19,649 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 16 time:  226.3051722049713
2026-01-21 17:12:05,550 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 17:12:05,652 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0053
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task balanced_accuracy: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task f1_score: 0.13 (std: 0.00, min: 0.13 at index 0, max: 0.133333 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score_weighted: 0.67 (std: 0.00, min: 0.67 at index 0, max: 0.666667 at index 0)

Node 0 metrics: test on val accuracy 0.5000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0054
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.092308 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.060000 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 1 metrics: test on val accuracy 0.3000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 17:14:16,632 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 16 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_16_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task balanced_accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.064815 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.043750 at index 0)
task f1_score_weighted: 0.52 (std: 0.00, min: 0.52 at index 0, max: 0.518519 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.35, 'balanced_accuracy': 0.35, 'f1_score': 0.06481481481481481, 'precision': 0.125, 'recall': 0.04375, 'f1_score_weighted': 0.5185185185185185}), 'accuracy': {'mean': 0.35, 'std': 0.0, 'min': 0.35, 'max': 0.35, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.35, 'std': 0.0, 'min': 0.35, 'max': 0.35, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.06481481481481481, 'std': 0.0, 'min': 0.06481481481481481, 'max': 0.06481481481481481, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.04375, 'std': 0.0, 'min': 0.04375, 'max': 0.04375, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.5185185185185185, 'std': 0.0, 'min': 0.5185185185185185, 'max': 0.5185185185185185, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task balanced_accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task f1_score: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.103704 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.070000 at index 0)
task f1_score_weighted: 0.52 (std: 0.00, min: 0.52 at index 0, max: 0.518519 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.35, 'balanced_accuracy': 0.35, 'f1_score': 0.1037037037037037, 'precision': 0.2, 'recall': 0.06999999999999999, 'f1_score_weighted': 0.5185185185185185}), 'accuracy': {'mean': 0.35, 'std': 0.0, 'min': 0.35, 'max': 0.35, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.35, 'std': 0.0, 'min': 0.35, 'max': 0.35, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.1037037037037037, 'std': 0.0, 'min': 0.1037037037037037, 'max': 0.1037037037037037, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.06999999999999999, 'std': 0.0, 'min': 0.06999999999999999, 'max': 0.06999999999999999, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.5185185185185185, 'std': 0.0, 'min': 0.5185185185185185, 'max': 0.5185185185185185, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 17-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 17:15:30,909 - flcore.servers.serverA2V - WARNING - === Round 17 starting hook temporally disabled ===
2026-01-21 17:15:30,913 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 17:15:31,994 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 17 time:  225.17523908615112
2026-01-21 17:19:16,842 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 17:19:16,941 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0047
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0 metrics: test on val accuracy 1.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0052
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 17:21:20,211 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 17 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_17_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.23 (std: 0.00, min: 0.23 at index 0, max: 0.225000 at index 0)
task balanced_accuracy: 0.22 (std: 0.00, min: 0.22 at index 0, max: 0.225000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.068698 at index 0)
task precision: 0.13 (std: 0.00, min: 0.13 at index 0, max: 0.126263 at index 0)
task recall: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score_weighted: 0.31 (std: 0.00, min: 0.31 at index 0, max: 0.309140 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.225, 'balanced_accuracy': 0.22499999999999998, 'f1_score': 0.06869772998805257, 'precision': 0.12626262626262624, 'recall': 0.049999999999999996, 'f1_score_weighted': 0.3091397849462365}), 'accuracy': {'mean': 0.225, 'std': 0.0, 'min': 0.225, 'max': 0.225, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.22499999999999998, 'std': 0.0, 'min': 0.22499999999999998, 'max': 0.22499999999999998, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.06869772998805257, 'std': 0.0, 'min': 0.06869772998805257, 'max': 0.06869772998805257, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.12626262626262624, 'std': 0.0, 'min': 0.12626262626262624, 'max': 0.12626262626262624, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.049999999999999996, 'std': 0.0, 'min': 0.049999999999999996, 'max': 0.049999999999999996, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3091397849462365, 'std': 0.0, 'min': 0.3091397849462365, 'max': 0.3091397849462365, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 18-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 17:22:30,003 - flcore.servers.serverA2V - WARNING - === Round 18 starting hook temporally disabled ===
2026-01-21 17:22:30,007 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 17:22:31,177 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 18 time:  230.6610734462738
2026-01-21 17:26:21,382 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 17:26:21,481 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0048
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 0 metrics: test on val accuracy 0.9500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0056
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.70 (std: 0.00, min: 0.70 at index 0, max: 0.700000 at index 0)
task balanced_accuracy: 0.70 (std: 0.00, min: 0.70 at index 0, max: 0.700000 at index 0)
task f1_score: 0.16 (std: 0.00, min: 0.16 at index 0, max: 0.164706 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.140000 at index 0)
task f1_score_weighted: 0.82 (std: 0.00, min: 0.82 at index 0, max: 0.823529 at index 0)

Node 1 metrics: test on val accuracy 0.7000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 17:28:25,163 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 18 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_18_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task balanced_accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task f1_score: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.141935 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.110000 at index 0)
task f1_score_weighted: 0.71 (std: 0.00, min: 0.71 at index 0, max: 0.709677 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.55, 'balanced_accuracy': 0.55, 'f1_score': 0.14193548387096774, 'precision': 0.2, 'recall': 0.11000000000000001, 'f1_score_weighted': 0.7096774193548387}), 'accuracy': {'mean': 0.55, 'std': 0.0, 'min': 0.55, 'max': 0.55, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.55, 'std': 0.0, 'min': 0.55, 'max': 0.55, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.14193548387096774, 'std': 0.0, 'min': 0.14193548387096774, 'max': 0.14193548387096774, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.11000000000000001, 'std': 0.0, 'min': 0.11000000000000001, 'max': 0.11000000000000001, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.7096774193548387, 'std': 0.0, 'min': 0.7096774193548387, 'max': 0.7096774193548387, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.090884 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.122078 at index 0)
task recall: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.085714 at index 0)
task f1_score_weighted: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.318095 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.3, 'balanced_accuracy': 0.3, 'f1_score': 0.0908843537414966, 'precision': 0.12207792207792208, 'recall': 0.08571428571428572, 'f1_score_weighted': 0.3180952380952381}), 'accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0908843537414966, 'std': 0.0, 'min': 0.0908843537414966, 'max': 0.0908843537414966, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.12207792207792208, 'std': 0.0, 'min': 0.12207792207792208, 'max': 0.12207792207792208, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.08571428571428572, 'std': 0.0, 'min': 0.08571428571428572, 'max': 0.08571428571428572, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3180952380952381, 'std': 0.0, 'min': 0.3180952380952381, 'max': 0.3180952380952381, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 19-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 17:29:33,737 - flcore.servers.serverA2V - WARNING - === Round 19 starting hook temporally disabled ===
2026-01-21 17:29:33,741 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 17:29:35,016 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 19 time:  230.50611019134521
2026-01-21 17:33:24,949 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 17:33:25,047 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0046
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.45 (std: 0.00, min: 0.45 at index 0, max: 0.450000 at index 0)
task balanced_accuracy: 0.45 (std: 0.00, min: 0.45 at index 0, max: 0.450000 at index 0)
task f1_score: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.103448 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task f1_score_weighted: 0.62 (std: 0.00, min: 0.62 at index 0, max: 0.620690 at index 0)

Node 0 metrics: test on val accuracy 0.4500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 17:35:28,332 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 19 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_19_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task balanced_accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task f1_score: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.114286 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.080000 at index 0)
task f1_score_weighted: 0.57 (std: 0.00, min: 0.57 at index 0, max: 0.571429 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.4, 'balanced_accuracy': 0.4, 'f1_score': 0.11428571428571428, 'precision': 0.2, 'recall': 0.08, 'f1_score_weighted': 0.5714285714285714}), 'accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.11428571428571428, 'std': 0.0, 'min': 0.11428571428571428, 'max': 0.11428571428571428, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.08, 'std': 0.0, 'min': 0.08, 'max': 0.08, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.5714285714285714, 'std': 0.0, 'min': 0.5714285714285714, 'max': 0.5714285714285714, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.23 (std: 0.00, min: 0.23 at index 0, max: 0.225000 at index 0)
task balanced_accuracy: 0.22 (std: 0.00, min: 0.22 at index 0, max: 0.225000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.067081 at index 0)
task precision: 0.16 (std: 0.00, min: 0.16 at index 0, max: 0.155556 at index 0)
task recall: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score_weighted: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.301863 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.225, 'balanced_accuracy': 0.22499999999999998, 'f1_score': 0.0670807453416149, 'precision': 0.15555555555555556, 'recall': 0.049999999999999996, 'f1_score_weighted': 0.3018633540372671}), 'accuracy': {'mean': 0.225, 'std': 0.0, 'min': 0.225, 'max': 0.225, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.22499999999999998, 'std': 0.0, 'min': 0.22499999999999998, 'max': 0.22499999999999998, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0670807453416149, 'std': 0.0, 'min': 0.0670807453416149, 'max': 0.0670807453416149, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.15555555555555556, 'std': 0.0, 'min': 0.15555555555555556, 'max': 0.15555555555555556, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.049999999999999996, 'std': 0.0, 'min': 0.049999999999999996, 'max': 0.049999999999999996, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3018633540372671, 'std': 0.0, 'min': 0.3018633540372671, 'max': 0.3018633540372671, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 20-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 17:36:51,077 - flcore.servers.serverA2V - WARNING - === Round 20 starting hook temporally disabled ===
2026-01-21 17:36:51,081 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 17:36:52,611 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 10 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 10 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 20 time:  221.17202043533325
2026-01-21 17:40:32,949 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-21 17:40:33,053 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0046
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task balanced_accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task f1_score: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.177419 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.137500 at index 0)
task f1_score_weighted: 0.71 (std: 0.00, min: 0.71 at index 0, max: 0.709677 at index 0)

Node 0 metrics: test on val accuracy 0.5500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_0_10le_20gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0051
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_1_10le_20gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 17:42:42,195 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 20 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_20_node_server_10le_20gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.70 (std: 0.00, min: 0.70 at index 0, max: 0.700000 at index 0)
task balanced_accuracy: 0.70 (std: 0.00, min: 0.70 at index 0, max: 0.700000 at index 0)
task f1_score: 0.16 (std: 0.00, min: 0.16 at index 0, max: 0.164706 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.140000 at index 0)
task f1_score_weighted: 0.82 (std: 0.00, min: 0.82 at index 0, max: 0.823529 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.7, 'balanced_accuracy': 0.7, 'f1_score': 0.16470588235294117, 'precision': 0.2, 'recall': 0.13999999999999999, 'f1_score_weighted': 0.8235294117647058}), 'accuracy': {'mean': 0.7, 'std': 0.0, 'min': 0.7, 'max': 0.7, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.7, 'std': 0.0, 'min': 0.7, 'max': 0.7, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.16470588235294117, 'std': 0.0, 'min': 0.16470588235294117, 'max': 0.16470588235294117, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.13999999999999999, 'std': 0.0, 'min': 0.13999999999999999, 'max': 0.13999999999999999, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.8235294117647058, 'std': 0.0, 'min': 0.8235294117647058, 'max': 0.8235294117647058, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.016667 at index 0)
task precision: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.012500 at index 0)
task f1_score_weighted: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.066667 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.016666666666666666, 'precision': 0.025, 'recall': 0.0125, 'f1_score_weighted': 0.06666666666666667}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.016666666666666666, 'std': 0.0, 'min': 0.016666666666666666, 'max': 0.016666666666666666, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0125, 'std': 0.0, 'min': 0.0125, 'max': 0.0125, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.06666666666666667, 'std': 0.0, 'min': 0.06666666666666667, 'max': 0.06666666666666667, 'min_index': 0, 'max_index': 0}})}
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)

Average time cost: 8715.36s.
std for best accurancy: nan
mean for best accurancy: nan
All done!
Wed Jan 21 05:44:14 PM UTC 2026
