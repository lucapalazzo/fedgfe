Wed Jan 21 09:25:12 PM UTC 2026
_CudaDeviceProperties(name='NVIDIA H100 80GB HBM3', major=9, minor=0, total_memory=81089MB, multi_processor_count=132, uuid=1eeb6a7d-acce-e170-a127-51b5967e81ed, L2_cache_size=50MB)
0 0

Applied default for experiment.goal: test
Applied default for experiment.device: cuda
Applied default for experiment.device_id: 0
Applied default for experiment.runs: 1
Applied default for experiment.seed: -1
Applied default for experiment.optimize_memory: False
Applied default for experiment.debug: False
Applied default for federation.join_ratio: 1.0
Applied default for federation.generate_images_frequency: 0
Applied default for model.num_classes: 10
Applied default for model.embedding_size: 768
Applied default for model.patch_size: 16
Applied default for training.momentum: 0.9
Applied default for training.learning_rate_schedule: False
Applied default for dataset.image_size: -1
Applied default for dataset.transform: False
Applied default for dataset.partition: pat
Applied default for dataset.dir_alpha: 0.1
Applied default for dataset.balance: False
Applied default for rewind.epochs: 0
Applied default for rewind.ratio: 0.0
Applied default for rewind.interval: 0
Applied default for rewind.strategy: none
Applied default for fedgfe.nodes_datasets: cifar10
Applied default for fedgfe.nodes_downstream_tasks: none
Applied default for fedgfe.nodes_pretext_tasks: 
Applied default for fedgfe.nodes_training_sequence: both
Applied default for fedgfe.cls_token_only: False
Applied default for fedgfe.limit_samples_number: 0
Applied default for feda2v.diffusion_type: sd
Applied default for feda2v.use_act_loss: False
Applied default for feda2v.use_text_loss: True
Applied default for feda2v.use_image_loss: False
Applied default for feda2v.audio_model_name: MIT/ast-finetuned-audioset-10-10-0.4593
Applied default for feda2v.image_model_name: google/vit-base-patch16-224-in21k
Applied default for feda2v.img_pipe_name: runwayml/stable-diffusion-v1-5
Applied default for feda2v.img_lcm_lora_id: latent-consistency/lcm-lora-sdv1-5
Applied default for feda2v.audio_pipe_name: cvssp/audioldm-l-full
Applied default for feda2v.steps: 1000
Applied default for feda2v.mode: train_nodata
Applied default for feda2v.ablation_type: only_t5
Applied default for feda2v.controllability_type: volume
Applied default for feda2v.target_img_path: data/img
Applied default for feda2v.img_out_path: exp/img
Applied default for feda2v.audio_out_path: exp/audio
Applied default for feda2v.class_to_activate: 8
Applied default for feda2v.single_class: False
Applied default for feda2v.checkpoint_name: best_model
Applied default for feda2v.project: sinestesia
Applied default for feda2v.entity: ctlab-team
Applied default for feda2v.wandb_mode: offline
Applied default for feda2v.global_model_train_from_generator: False
Applied default for feda2v.global_model_train_from_nodes_audio_embeddings: False
Applied default for feda2v.global_model_train_inputs: none
Applied default for feda2v.adapter_aggregation_method: none
Applied default for feda2v.text_losses_summed: False
Applied default for feda2v.compute_global_mean_from_class_means: False
Applied default for feda2v.generation_split_for_metrics: ['test', 'val']
Applied default for feda2v.synthetic_samples_per_class: auto
Applied default for feda2v.reset_generator_on_class_change: True
Applied default for feda2v.shared_generator_in_only_mode: True
Applied default for nodes.0.dataset_split: all
Applied default for nodes.0.pretext_tasks: []
Applied default for nodes.0.task_type: classification
Applied default for nodes.0.balance_classes: False
Applied default for nodes.0.use_folds: False
Applied default for nodes.0.train_folds: [0, 1, 2, 3]
Applied default for nodes.0.test_folds: [4]
Applied default for nodes.1.dataset_split: all
Applied default for nodes.1.pretext_tasks: []
Applied default for nodes.1.task_type: classification
Applied default for nodes.1.balance_classes: False
Applied default for nodes.1.use_folds: False
Applied default for nodes.1.train_folds: [0, 1, 2, 3]
Applied default for nodes.1.test_folds: [4]
Warning: Could not map class label 'dog' to numeric index
Node 0: Selected classes ['dog'] -> []
Warning: Could not map class label 'chainsaw' to numeric index
Node 1: Selected classes ['chainsaw'] -> []
Set num_clients: 2
Successfully loaded configuration from: configs/a2v_vegas_2n_2c_200s_kd.json
Using nodes_tasks from config file (already processed)
==================================================
Algorithm: FedA2V
Local batch size: 8
Local epochs: 20
Local learing rate: 0.001
Local learing rate schedule: False
Total number of clients: 2
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: VEGAS
Number of classes: 10
Backbone: a2v
Using device: cuda
Using DP: False
Auto break: False
Global rounds: 10
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
A2V G model sd

============= Running time: 0th =============
Creating server and clients ...
None
Enabling wandb to progect:  FedA2V
Finished creating server and clients.
2026-01-21 21:25:24,282 - utils.ballooning - INFO - Initialized GPUMemoryBalloon for GPU 0
2026-01-21 21:25:24,514 - utils.ballooning - INFO - GPU 0: Total memory: 81089 MB, Free before: 80563 MB, Target reserve: 0 MB
2026-01-21 21:25:24,514 - utils.ballooning - INFO - GPU 0: Successfully allocated 0 MB. Free memory: 80563 MB -> 80563 MB
2026-01-21 21:25:26,179 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - Initializing AST model: MIT/ast-finetuned-audioset-10-10-0.4593
2026-01-21 21:25:26,869 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - AST model initialized successfully
Started diffusion model flux
2026-01-21 21:25:31,811 - flcore.servers.serverA2V - INFO - Generator checkpoint loading deferred until after client creation
Creating 0 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['dog']
2026-01-21 21:25:31,824 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-21 21:25:31,824 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-21 21:25:32,018 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:32,018 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:32,211 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:32,211 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:32,215 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 160 samples, classes: ['dog'], split: train
2026-01-21 21:25:32,215 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-21 21:25:32,408 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:32,408 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:32,591 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:32,592 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:32,595 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['dog'], split: val
2026-01-21 21:25:32,595 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-21 21:25:32,789 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:32,789 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:32,973 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:32,973 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:32,976 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['dog'], split: test
2026-01-21 21:25:32,976 - datautils.dataset_vegas - INFO - Auto-split created: train=160, val=20, test=20
2026-01-21 21:25:33,157 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:33,157 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:33,338 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 21:25:33,338 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:33,339 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['dog'], split: None
Stratified split: train=160, val=20, test=20
Trying to set schdulers but no optimizer for client  0
2026-01-21 21:25:35,833 - flcore.clients.clientA2V - INFO - Node 0: Using global use_cls_token_only=False
2026-01-21 21:25:36,898 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-21 21:25:36,900 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-21 21:25:36,900 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=160, val=20, test=20
[Client 0] Auto-calculated synthetic_samples_per_class = 160 (total samples: 160, classes: 1)
Creating 1 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['chainsaw']
2026-01-21 21:25:41,976 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-21 21:25:41,976 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-21 21:25:42,106 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,106 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,227 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,228 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,231 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 160 samples, classes: ['chainsaw'], split: train
2026-01-21 21:25:42,231 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-21 21:25:42,361 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,361 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,483 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,483 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,486 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['chainsaw'], split: val
2026-01-21 21:25:42,486 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-21 21:25:42,616 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,616 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,736 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,736 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,738 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['chainsaw'], split: test
2026-01-21 21:25:42,739 - datautils.dataset_vegas - INFO - Auto-split created: train=160, val=20, test=20
2026-01-21 21:25:42,857 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,857 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,977 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 21:25:42,977 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 21:25:42,978 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['chainsaw'], split: None
Stratified split: train=160, val=20, test=20
Trying to set schdulers but no optimizer for client  1
2026-01-21 21:25:45,285 - flcore.clients.clientA2V - INFO - Node 1: Using global use_cls_token_only=False
2026-01-21 21:25:46,303 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-21 21:25:46,304 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-21 21:25:46,305 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=160, val=20, test=20
[Client 1] Auto-calculated synthetic_samples_per_class = 160 (total samples: 160, classes: 1)
Created server test dataset with 40 samples from 2 nodes
2026-01-21 21:25:50,877 - flcore.servers.serverA2V - INFO - [Server] Auto-calculating synthetic_samples_per_class for each node and class
2026-01-21 21:25:50,877 - flcore.servers.serverA2V - INFO - [Server] Node 0: 160 synthetic samples/class (total samples: 160, classes: 1)
2026-01-21 21:25:50,877 - flcore.servers.serverA2V - INFO - [Server] Node 1: 160 synthetic samples/class (total samples: 160, classes: 1)
2026-01-21 21:25:50,877 - flcore.servers.serverA2V - INFO - [Server] Average synthetic_samples_per_class = 160
2026-01-21 21:25:50,877 - flcore.servers.serverA2V - INFO - Loading generator checkpoints now that federation classes are available **TEMPORARY DISABLED**
2026-01-21 21:25:50,878 - flcore.servers.serverA2V - WARNING - No generator checkpoints found in checkpoints/generators/vegas-20n-10c-200s-real
2026-01-21 21:25:50,878 - flcore.servers.serverA2V - WARNING - Could not load generator checkpoint, initializing from scratch
2026-01-21 21:25:50,878 - flcore.servers.serverA2V - INFO - Initializing vae generator on server (conditioned=None)
2026-01-21 21:26:21,322 - flcore.servers.serverA2V - INFO - Unconditioned VAE generator initialized
2026-01-21 21:26:21,323 - flcore.servers.serverA2V - INFO - 
[Server] Generating synthetic samples for all nodes after generator loading
2026-01-21 21:26:21,323 - flcore.servers.serverA2V - WARNING - [Server] No generators available, cannot generate synthetic samples
2026-01-21 21:26:21,323 - flcore.servers.serverA2V - WARNING - [Server] No synthetic samples to distribute

*** Client 0 dataset VEGAS
2026-01-21 21:26:21,323 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.

*** Client 1 dataset VEGAS
2026-01-21 21:26:21,323 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.
2026-01-21 21:26:21,325 - flcore.servers.serverA2V - INFO - Finished creating Audio2Visual server and clients.

-------------Round number: 1-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 21:26:21,635 - flcore.servers.serverA2V - WARNING - === Round 1 starting hook temporally disabled ===
2026-01-21 21:26:21,920 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 21:26:23,171 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Creating dataloader for train dataset for client 0 with 160 samples
Creating dataloader for test dataset for client 0 with 20 samples
Creating optimizer for node 0 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 0
Node 0: No optimizer initialized
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 0] ‚ö†Ô∏è  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

üìä MEMORY SUMMARY:
  Start:  Allocated=2.97 GB, Reserved=3.11 GB (3.9%)
  End:    Allocated=5.79 GB, Reserved=7.32 GB (9.2%)
  Growth: Allocated=+2.816 GB, Reserved=+4.209 GB

üìà PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Œî Alloc         Œî Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.8722
2          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.2511
3          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0613
4          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0157
5          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0113
6          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0101
7          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0094
8          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0090
9          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0088
10         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0086
11         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0085
12         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0085
13         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
14         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
15         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
16         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
17         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
18         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
19         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
20         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084

  üî¥ Max growth at Epoch 1: +4.209 GB reserved
====================================================================================================


Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Creating dataloader for train dataset for client 1 with 160 samples
Creating dataloader for test dataset for client 1 with 20 samples
Creating optimizer for node 1 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 1
Node 1: No optimizer initialized
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 1] ‚ö†Ô∏è  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

üìä MEMORY SUMMARY:
  Start:  Allocated=2.47 GB, Reserved=2.56 GB (3.2%)
  End:    Allocated=5.22 GB, Reserved=6.81 GB (8.6%)
  Growth: Allocated=+2.755 GB, Reserved=+4.258 GB

üìà PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Œî Alloc         Œî Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.8737
2          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.2561
3          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0629
4          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0167
5          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0126
6          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0113
7          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0106
8          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0102
9          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0099
10         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0097
11         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0096
12         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0096
13         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
14         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
15         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
16         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
17         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
18         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
19         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0094
20         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0094

  üî¥ Max growth at Epoch 1: +4.258 GB reserved
====================================================================================================


Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 1 time:  486.031795501709
2026-01-21 21:34:27,668 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 21:34:27,668 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 21:34:27,668 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 21:34:43,136 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 21:35:21,767 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 21:35:54,057 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 1 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_1_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.018182 at index 0)
task precision: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.010000 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.01818181818181818, 'precision': 0.1, 'recall': 0.01, 'f1_score_weighted': 0.18181818181818182}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.01818181818181818, 'std': 0.0, 'min': 0.01818181818181818, 'max': 0.01818181818181818, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01, 'std': 0.0, 'min': 0.01, 'max': 0.01, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.18181818181818182, 'std': 0.0, 'min': 0.18181818181818182, 'max': 0.18181818181818182, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task balanced_accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.019048 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.010000 at index 0)
task f1_score_weighted: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.025, 'balanced_accuracy': 0.025, 'f1_score': 0.019047619047619046, 'precision': 0.2, 'recall': 0.01, 'f1_score_weighted': 0.047619047619047616}), 'accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.019047619047619046, 'std': 0.0, 'min': 0.019047619047619046, 'max': 0.019047619047619046, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01, 'std': 0.0, 'min': 0.01, 'max': 0.01, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.047619047619047616, 'std': 0.0, 'min': 0.047619047619047616, 'max': 0.047619047619047616, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 2-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 21:37:11,400 - flcore.servers.serverA2V - WARNING - === Round 2 starting hook temporally disabled ===
2026-01-21 21:37:11,404 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 21:37:13,112 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 2 time:  446.1253228187561
2026-01-21 21:44:37,527 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 21:44:37,527 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 21:44:37,527 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 21:44:51,649 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 21:45:29,374 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 21:45:55,880 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 2 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_2_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057692 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037500 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.3, 'balanced_accuracy': 0.3, 'f1_score': 0.057692307692307696, 'precision': 0.125, 'recall': 0.0375, 'f1_score_weighted': 0.46153846153846156}), 'accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.057692307692307696, 'std': 0.0, 'min': 0.057692307692307696, 'max': 0.057692307692307696, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0375, 'std': 0.0, 'min': 0.0375, 'max': 0.0375, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.46153846153846156, 'std': 0.0, 'min': 0.46153846153846156, 'max': 0.46153846153846156, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task balanced_accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.019048 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.010000 at index 0)
task f1_score_weighted: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.025, 'balanced_accuracy': 0.025, 'f1_score': 0.019047619047619046, 'precision': 0.2, 'recall': 0.01, 'f1_score_weighted': 0.047619047619047616}), 'accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.019047619047619046, 'std': 0.0, 'min': 0.019047619047619046, 'max': 0.019047619047619046, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01, 'std': 0.0, 'min': 0.01, 'max': 0.01, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.047619047619047616, 'std': 0.0, 'min': 0.047619047619047616, 'max': 0.047619047619047616, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 3-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 21:47:08,376 - flcore.servers.serverA2V - WARNING - === Round 3 starting hook temporally disabled ===
2026-01-21 21:47:08,380 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 21:47:09,956 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 3 time:  430.9257164001465
2026-01-21 21:54:19,303 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 21:54:19,303 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 21:54:19,303 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 21:54:34,132 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 21:55:10,051 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 21:55:36,029 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 3 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_3_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.022727 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.012500 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.022727272727272728, 'precision': 0.125, 'recall': 0.0125, 'f1_score_weighted': 0.18181818181818182}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.022727272727272728, 'std': 0.0, 'min': 0.022727272727272728, 'max': 0.022727272727272728, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0125, 'std': 0.0, 'min': 0.0125, 'max': 0.0125, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.18181818181818182, 'std': 0.0, 'min': 0.18181818181818182, 'max': 0.18181818181818182, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task balanced_accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.019048 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.010000 at index 0)
task f1_score_weighted: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.025, 'balanced_accuracy': 0.025, 'f1_score': 0.019047619047619046, 'precision': 0.2, 'recall': 0.01, 'f1_score_weighted': 0.047619047619047616}), 'accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.019047619047619046, 'std': 0.0, 'min': 0.019047619047619046, 'max': 0.019047619047619046, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01, 'std': 0.0, 'min': 0.01, 'max': 0.01, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.047619047619047616, 'std': 0.0, 'min': 0.047619047619047616, 'max': 0.047619047619047616, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 4-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 21:56:44,001 - flcore.servers.serverA2V - WARNING - === Round 4 starting hook temporally disabled ===
2026-01-21 21:56:44,004 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 21:56:45,216 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 4 time:  412.7475516796112
2026-01-21 22:03:36,749 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 22:03:36,749 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 22:03:36,749 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 22:03:50,499 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 22:04:26,939 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 22:04:53,766 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 4 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_4_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.05714285714285715, 'precision': 0.14285714285714285, 'recall': 0.03571428571428571, 'f1_score_weighted': 0.4}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.05714285714285715, 'std': 0.0, 'min': 0.05714285714285715, 'max': 0.05714285714285715, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03571428571428571, 'std': 0.0, 'min': 0.03571428571428571, 'max': 0.03571428571428571, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task balanced_accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.019048 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.010000 at index 0)
task f1_score_weighted: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.025, 'balanced_accuracy': 0.025, 'f1_score': 0.019047619047619046, 'precision': 0.2, 'recall': 0.01, 'f1_score_weighted': 0.047619047619047616}), 'accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.019047619047619046, 'std': 0.0, 'min': 0.019047619047619046, 'max': 0.019047619047619046, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01, 'std': 0.0, 'min': 0.01, 'max': 0.01, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.047619047619047616, 'std': 0.0, 'min': 0.047619047619047616, 'max': 0.047619047619047616, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 5-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 22:05:58,346 - flcore.servers.serverA2V - WARNING - === Round 5 starting hook temporally disabled ===
2026-01-21 22:05:58,350 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 22:05:59,459 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 5 time:  406.5751631259918
2026-01-21 22:12:44,922 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 22:12:44,923 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 22:12:44,923 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 22:12:58,217 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 22:13:39,623 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 22:14:07,509 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 5 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_5_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.031250 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.05, 'precision': 0.125, 'recall': 0.03125, 'f1_score_weighted': 0.4}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03125, 'std': 0.0, 'min': 0.03125, 'max': 0.03125, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.9, 'balanced_accuracy': 0.9, 'f1_score': 0.3157894736842105, 'precision': 0.3333333333333333, 'recall': 0.3, 'f1_score_weighted': 0.9473684210526315}), 'accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.3157894736842105, 'std': 0.0, 'min': 0.3157894736842105, 'max': 0.3157894736842105, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9473684210526315, 'std': 0.0, 'min': 0.9473684210526315, 'max': 0.9473684210526315, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 6-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 22:15:21,713 - flcore.servers.serverA2V - WARNING - === Round 6 starting hook temporally disabled ===
2026-01-21 22:15:21,717 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 22:15:23,086 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 6 time:  403.46311259269714
2026-01-21 22:22:05,177 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 22:22:05,178 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 22:22:05,178 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 22:22:17,542 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 22:22:53,201 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 22:23:19,761 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 6 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_6_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.028571 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.2, 'balanced_accuracy': 0.2, 'f1_score': 0.047619047619047616, 'precision': 0.14285714285714285, 'recall': 0.028571428571428574, 'f1_score_weighted': 0.3333333333333333}), 'accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.047619047619047616, 'std': 0.0, 'min': 0.047619047619047616, 'max': 0.047619047619047616, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.028571428571428574, 'std': 0.0, 'min': 0.028571428571428574, 'max': 0.028571428571428574, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.9, 'balanced_accuracy': 0.9, 'f1_score': 0.3157894736842105, 'precision': 0.3333333333333333, 'recall': 0.3, 'f1_score_weighted': 0.9473684210526315}), 'accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.3157894736842105, 'std': 0.0, 'min': 0.3157894736842105, 'max': 0.3157894736842105, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9473684210526315, 'std': 0.0, 'min': 0.9473684210526315, 'max': 0.9473684210526315, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 7-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 22:24:23,263 - flcore.servers.serverA2V - WARNING - === Round 7 starting hook temporally disabled ===
2026-01-21 22:24:23,266 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 22:24:24,482 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 7 time:  394.97132325172424
2026-01-21 22:30:58,235 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 22:30:58,235 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 22:30:58,236 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0049
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 22:31:09,396 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0049

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 22:31:44,706 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 22:32:10,910 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 7 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_7_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.080000 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.08, 'precision': 0.2, 'recall': 0.05, 'f1_score_weighted': 0.4}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.08, 'std': 0.0, 'min': 0.08, 'max': 0.08, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.9, 'balanced_accuracy': 0.9, 'f1_score': 0.3157894736842105, 'precision': 0.3333333333333333, 'recall': 0.3, 'f1_score_weighted': 0.9473684210526315}), 'accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.3157894736842105, 'std': 0.0, 'min': 0.3157894736842105, 'max': 0.3157894736842105, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9473684210526315, 'std': 0.0, 'min': 0.9473684210526315, 'max': 0.9473684210526315, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 8-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 22:33:14,393 - flcore.servers.serverA2V - WARNING - === Round 8 starting hook temporally disabled ===
2026-01-21 22:33:14,397 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 22:33:15,911 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 8 time:  393.9792330265045
2026-01-21 22:39:48,373 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 22:39:48,374 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 22:39:48,374 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 22:39:59,433 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 22:40:36,368 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 22:41:00,559 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 8 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_8_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057692 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037500 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.3, 'balanced_accuracy': 0.3, 'f1_score': 0.057692307692307696, 'precision': 0.125, 'recall': 0.0375, 'f1_score_weighted': 0.46153846153846156}), 'accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.057692307692307696, 'std': 0.0, 'min': 0.057692307692307696, 'max': 0.057692307692307696, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0375, 'std': 0.0, 'min': 0.0375, 'max': 0.0375, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.46153846153846156, 'std': 0.0, 'min': 0.46153846153846156, 'max': 0.46153846153846156, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.9, 'balanced_accuracy': 0.9, 'f1_score': 0.3157894736842105, 'precision': 0.3333333333333333, 'recall': 0.3, 'f1_score_weighted': 0.9473684210526315}), 'accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.3157894736842105, 'std': 0.0, 'min': 0.3157894736842105, 'max': 0.3157894736842105, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9473684210526315, 'std': 0.0, 'min': 0.9473684210526315, 'max': 0.9473684210526315, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.045455 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score_weighted: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.090909 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.045454545454545456, 'precision': 0.25, 'recall': 0.025, 'f1_score_weighted': 0.09090909090909091}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.045454545454545456, 'std': 0.0, 'min': 0.045454545454545456, 'max': 0.045454545454545456, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09090909090909091, 'std': 0.0, 'min': 0.09090909090909091, 'max': 0.09090909090909091, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 9-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 22:42:01,959 - flcore.servers.serverA2V - WARNING - === Round 9 starting hook temporally disabled ===
2026-01-21 22:42:01,963 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 22:42:02,832 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 9 time:  411.5915102958679
2026-01-21 22:48:53,552 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 22:48:53,552 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 22:48:53,552 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 22:49:08,557 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 22:49:42,170 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 22:50:09,424 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 9 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_9_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037037 at index 0)
task precision: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.111111 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.022222 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.2, 'balanced_accuracy': 0.2, 'f1_score': 0.037037037037037035, 'precision': 0.1111111111111111, 'recall': 0.022222222222222223, 'f1_score_weighted': 0.3333333333333333}), 'accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.037037037037037035, 'std': 0.0, 'min': 0.037037037037037035, 'max': 0.037037037037037035, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.1111111111111111, 'std': 0.0, 'min': 0.1111111111111111, 'max': 0.1111111111111111, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.022222222222222223, 'std': 0.0, 'min': 0.022222222222222223, 'max': 0.022222222222222223, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.036364 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.020000 at index 0)
task f1_score_weighted: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.090909 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.03636363636363636, 'precision': 0.2, 'recall': 0.02, 'f1_score_weighted': 0.09090909090909091}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.03636363636363636, 'std': 0.0, 'min': 0.03636363636363636, 'max': 0.03636363636363636, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.02, 'std': 0.0, 'min': 0.02, 'max': 0.02, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09090909090909091, 'std': 0.0, 'min': 0.09090909090909091, 'max': 0.09090909090909091, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 10-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 22:51:07,472 - flcore.servers.serverA2V - WARNING - === Round 10 starting hook temporally disabled ===
2026-01-21 22:51:07,475 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-21 22:51:08,446 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 10 time:  382.3127233982086
2026-01-21 22:57:29,785 - flcore.servers.serverA2V - INFO - [KD Aggregation] Starting Knowledge Distillation adapter aggregation
2026-01-21 22:57:29,786 - flcore.servers.serverA2V - ERROR - [KD Aggregation] No generators available, cannot perform KD aggregation
2026-01-21 22:57:29,786 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from generated split using server's diffusion model
2026-01-21 22:57:41,876 - flcore.clients.clientA2V - WARNING - Client 0: No images were generated, falling back to standard metrics
Node 0 metrics: test on val text_loss 0.0042

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_0_20le_5gr_kd_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from generated split using server's diffusion model
2026-01-21 22:58:18,043 - flcore.clients.clientA2V - WARNING - Client 1: No images were generated, falling back to standard metrics
Node 1 metrics: test on val text_loss 0.0048

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_1_20le_5gr_kd_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-21 22:58:51,416 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 10 on test split
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-kd/round_10_node_server_20le_5gr_kd_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task balanced_accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task f1_score: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.081633 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task f1_score_weighted: 0.57 (std: 0.00, min: 0.57 at index 0, max: 0.571429 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.4, 'balanced_accuracy': 0.4, 'f1_score': 0.08163265306122448, 'precision': 0.14285714285714285, 'recall': 0.05714285714285715, 'f1_score_weighted': 0.5714285714285714}), 'accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.08163265306122448, 'std': 0.0, 'min': 0.08163265306122448, 'max': 0.08163265306122448, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.05714285714285715, 'std': 0.0, 'min': 0.05714285714285715, 'max': 0.05714285714285715, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.5714285714285714, 'std': 0.0, 'min': 0.5714285714285714, 'max': 0.5714285714285714, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)

Average time cost: 5684.11s.
std for best accurancy: nan
mean for best accurancy: nan
All done!
Wed Jan 21 11:00:15 PM UTC 2026
