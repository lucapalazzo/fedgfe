_CudaDeviceProperties(name='NVIDIA H100 80GB HBM3', major=9, minor=0, total_memory=81089MB, multi_processor_count=132, uuid=c546c563-f710-f725-8e32-77f58b4c78c7, L2_cache_size=50MB)
0 0

Applied default for experiment.goal: test
Applied default for experiment.device: cuda
Applied default for experiment.device_id: 0
Applied default for experiment.runs: 1
Applied default for experiment.seed: -1
Applied default for experiment.optimize_memory: False
Applied default for experiment.debug: False
Applied default for federation.join_ratio: 1.0
Applied default for federation.generate_images_frequency: 0
Applied default for model.num_classes: 10
Applied default for model.embedding_size: 768
Applied default for model.patch_size: 16
Applied default for training.momentum: 0.9
Applied default for training.learning_rate_schedule: False
Applied default for dataset.image_size: -1
Applied default for dataset.transform: False
Applied default for dataset.partition: pat
Applied default for dataset.dir_alpha: 0.1
Applied default for dataset.balance: False
Applied default for rewind.epochs: 0
Applied default for rewind.ratio: 0.0
Applied default for rewind.interval: 0
Applied default for rewind.strategy: none
Applied default for fedgfe.nodes_datasets: cifar10
Applied default for fedgfe.nodes_downstream_tasks: none
Applied default for fedgfe.nodes_pretext_tasks: 
Applied default for fedgfe.nodes_training_sequence: both
Applied default for fedgfe.cls_token_only: False
Applied default for fedgfe.limit_samples_number: 0
Applied default for feda2v.diffusion_type: sd
Applied default for feda2v.use_act_loss: False
Applied default for feda2v.use_text_loss: True
Applied default for feda2v.use_image_loss: False
Applied default for feda2v.audio_model_name: MIT/ast-finetuned-audioset-10-10-0.4593
Applied default for feda2v.image_model_name: google/vit-base-patch16-224-in21k
Applied default for feda2v.img_pipe_name: runwayml/stable-diffusion-v1-5
Applied default for feda2v.img_lcm_lora_id: latent-consistency/lcm-lora-sdv1-5
Applied default for feda2v.audio_pipe_name: cvssp/audioldm-l-full
Applied default for feda2v.steps: 1000
Applied default for feda2v.mode: train_nodata
Applied default for feda2v.ablation_type: only_t5
Applied default for feda2v.controllability_type: volume
Applied default for feda2v.target_img_path: data/img
Applied default for feda2v.img_out_path: exp/img
Applied default for feda2v.audio_out_path: exp/audio
Applied default for feda2v.class_to_activate: 8
Applied default for feda2v.single_class: False
Applied default for feda2v.checkpoint_name: best_model
Applied default for feda2v.project: sinestesia
Applied default for feda2v.entity: ctlab-team
Applied default for feda2v.wandb_mode: offline
Applied default for feda2v.global_model_train_from_generator: False
Applied default for feda2v.global_model_train_from_nodes_audio_embeddings: False
Applied default for feda2v.global_model_train_inputs: none
Applied default for feda2v.adapter_aggregation_method: none
Applied default for feda2v.text_losses_summed: False
Applied default for feda2v.compute_global_mean_from_class_means: False
Applied default for feda2v.generation_split_for_metrics: ['test', 'val']
Applied default for feda2v.synthetic_samples_per_class: auto
Applied default for feda2v.reset_generator_on_class_change: True
Applied default for feda2v.shared_generator_in_only_mode: True
Applied default for nodes.0.dataset_split: all
Applied default for nodes.0.pretext_tasks: []
Applied default for nodes.0.task_type: classification
Applied default for nodes.0.balance_classes: False
Applied default for nodes.0.use_folds: False
Applied default for nodes.0.train_folds: [0, 1, 2, 3]
Applied default for nodes.0.test_folds: [4]
Applied default for nodes.1.dataset_split: all
Applied default for nodes.1.pretext_tasks: []
Applied default for nodes.1.task_type: classification
Applied default for nodes.1.balance_classes: False
Applied default for nodes.1.use_folds: False
Applied default for nodes.1.train_folds: [0, 1, 2, 3]
Applied default for nodes.1.test_folds: [4]
Warning: Could not map class label 'dog' to numeric index
Node 0: Selected classes ['dog'] -> []
Warning: Could not map class label 'chainsaw' to numeric index
Node 1: Selected classes ['chainsaw'] -> []
Set num_clients: 2
Successfully loaded configuration from: configs/a2v_vegas_2n_2c_200s_avg.json
Using nodes_tasks from config file (already processed)
==================================================
Algorithm: FedA2V
Local batch size: 8
Local epochs: 20
Local learing rate: 0.001
Local learing rate schedule: False
Total number of clients: 2
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: VEGAS
Number of classes: 10
Backbone: a2v
Using device: cuda
Using DP: False
Auto break: False
Global rounds: 10
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
A2V G model sd

============= Running time: 0th =============
Creating server and clients ...
None
Enabling wandb to progect:  FedA2V
Finished creating server and clients.
2026-01-20 16:52:12,060 - utils.ballooning - INFO - Initialized GPUMemoryBalloon for GPU 0
2026-01-20 16:52:12,328 - utils.ballooning - INFO - GPU 0: Total memory: 81089 MB, Free before: 80563 MB, Target reserve: 0 MB
2026-01-20 16:52:12,329 - utils.ballooning - INFO - GPU 0: Successfully allocated 0 MB. Free memory: 80563 MB -> 80563 MB
2026-01-20 16:52:13,730 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - Initializing AST model: MIT/ast-finetuned-audioset-10-10-0.4593
2026-01-20 16:52:14,343 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - AST model initialized successfully
Started diffusion model flux
Creating 0 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['dog']
2026-01-20 16:52:19,384 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-20 16:52:19,384 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-20 16:52:19,578 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:19,578 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:19,760 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:19,760 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:19,763 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 160 samples, classes: ['dog'], split: train
2026-01-20 16:52:19,763 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-20 16:52:19,951 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:19,951 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:20,133 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:20,134 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:20,137 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['dog'], split: val
2026-01-20 16:52:20,137 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-20 16:52:20,326 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:20,326 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:20,505 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:20,506 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:20,508 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['dog'], split: test
2026-01-20 16:52:20,508 - datautils.dataset_vegas - INFO - Auto-split created: train=160, val=20, test=20
2026-01-20 16:52:20,686 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:20,686 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:20,866 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-20 16:52:20,866 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:20,868 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['dog'], split: None
Stratified split: train=160, val=20, test=20
Trying to set schdulers but no optimizer for client  0
2026-01-20 16:52:23,167 - flcore.clients.clientA2V - INFO - Node 0: Using global use_cls_token_only=False
2026-01-20 16:52:24,085 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-20 16:52:24,086 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-20 16:52:24,086 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=160, val=20, test=20
[Client 0] Auto-calculated synthetic_samples_per_class = 160 (total samples: 160, classes: 1)
Creating 1 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['chainsaw']
2026-01-20 16:52:28,444 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-20 16:52:28,444 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-20 16:52:28,572 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:28,573 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:28,694 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:28,694 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:28,697 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 160 samples, classes: ['chainsaw'], split: train
2026-01-20 16:52:28,697 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-20 16:52:28,828 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:28,829 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:28,952 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:28,952 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:28,955 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['chainsaw'], split: val
2026-01-20 16:52:28,955 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-20 16:52:29,086 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:29,087 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:29,211 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:29,212 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:29,214 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['chainsaw'], split: test
2026-01-20 16:52:29,214 - datautils.dataset_vegas - INFO - Auto-split created: train=160, val=20, test=20
2026-01-20 16:52:29,334 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:29,335 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:29,455 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-20 16:52:29,456 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-20 16:52:29,457 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['chainsaw'], split: None
Stratified split: train=160, val=20, test=20
Trying to set schdulers but no optimizer for client  1
2026-01-20 16:52:31,609 - flcore.clients.clientA2V - INFO - Node 1: Using global use_cls_token_only=False
2026-01-20 16:52:32,568 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-20 16:52:32,569 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-20 16:52:32,569 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=160, val=20, test=20
[Client 1] Auto-calculated synthetic_samples_per_class = 160 (total samples: 160, classes: 1)
Created server test dataset with 40 samples from 2 nodes
2026-01-20 16:52:37,084 - flcore.servers.serverA2V - INFO - [Server] Auto-calculating synthetic_samples_per_class for each node and class
2026-01-20 16:52:37,084 - flcore.servers.serverA2V - INFO - [Server] Node 0: 160 synthetic samples/class (total samples: 160, classes: 1)
2026-01-20 16:52:37,085 - flcore.servers.serverA2V - INFO - [Server] Node 1: 160 synthetic samples/class (total samples: 160, classes: 1)
2026-01-20 16:52:37,085 - flcore.servers.serverA2V - INFO - [Server] Average synthetic_samples_per_class = 160

*** Client 0 dataset VEGAS
2026-01-20 16:52:37,085 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.

*** Client 1 dataset VEGAS
2026-01-20 16:52:37,085 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.
2026-01-20 16:52:37,087 - flcore.servers.serverA2V - INFO - Finished creating Audio2Visual server and clients.

-------------Round number: 1-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 16:52:37,406 - flcore.servers.serverA2V - WARNING - === Round 1 starting hook temporally disabled ===
2026-01-20 16:52:37,665 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 16:52:39,021 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Creating dataloader for train dataset for client 0 with 160 samples
Creating dataloader for test dataset for client 0 with 20 samples
Creating optimizer for node 0 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 0
Node 0: No optimizer initialized
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 0] ‚ö†Ô∏è  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

üìä MEMORY SUMMARY:
  Start:  Allocated=2.97 GB, Reserved=3.11 GB (3.9%)
  End:    Allocated=5.79 GB, Reserved=7.32 GB (9.2%)
  Growth: Allocated=+2.816 GB, Reserved=+4.209 GB

üìà PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Œî Alloc         Œî Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.8714
2          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.2471
3          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0593
4          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0152
5          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0114
6          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0101
7          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0094
8          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0090
9          5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0088
10         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0086
11         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0085
12         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0085
13         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
14         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
15         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0084
16         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0083
17         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0083
18         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0083
19         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0082
20         5.79 GB            7.32 GB          +2.816 GB     +4.209 GB     0.0081

  üî¥ Max growth at Epoch 1: +4.209 GB reserved
====================================================================================================


Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Creating dataloader for train dataset for client 1 with 160 samples
Creating dataloader for test dataset for client 1 with 20 samples
Creating optimizer for node 1 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 1
Node 1: No optimizer initialized
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 1] ‚ö†Ô∏è  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

üìä MEMORY SUMMARY:
  Start:  Allocated=2.47 GB, Reserved=2.56 GB (3.2%)
  End:    Allocated=5.22 GB, Reserved=6.81 GB (8.6%)
  Growth: Allocated=+2.755 GB, Reserved=+4.258 GB

üìà PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Œî Alloc         Œî Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.9057
2          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.2894
3          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0761
4          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0171
5          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0129
6          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0113
7          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0106
8          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0102
9          5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0099
10         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0098
11         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0097
12         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0096
13         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0096
14         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0096
15         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0096
16         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0096
17         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
18         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
19         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095
20         5.22 GB            6.81 GB          +2.755 GB     +4.258 GB     0.0095

  üî¥ Max growth at Epoch 1: +4.258 GB reserved
====================================================================================================


Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 1 time:  340.24849367141724
2026-01-20 16:58:18,326 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 16:58:18,447 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0043
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.020202 at index 0)
task precision: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.111111 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.011111 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0 metrics: test on val accuracy 0.1000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 17:00:17,686 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 1 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_1_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.019048 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.010000 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.019047619047619046, 'precision': 0.2, 'recall': 0.01, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.019047619047619046, 'std': 0.0, 'min': 0.019047619047619046, 'max': 0.019047619047619046, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01, 'std': 0.0, 'min': 0.01, 'max': 0.01, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.95, 'balanced_accuracy': 0.95, 'f1_score': 0.48717948717948717, 'precision': 0.5, 'recall': 0.475, 'f1_score_weighted': 0.9743589743589742}), 'accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.95, 'std': 0.0, 'min': 0.95, 'max': 0.95, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.48717948717948717, 'std': 0.0, 'min': 0.48717948717948717, 'max': 0.48717948717948717, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.475, 'std': 0.0, 'min': 0.475, 'max': 0.475, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9743589743589742, 'std': 0.0, 'min': 0.9743589743589742, 'max': 0.9743589743589742, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 2-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 17:01:44,320 - flcore.servers.serverA2V - WARNING - === Round 2 starting hook temporally disabled ===
2026-01-20 17:01:44,324 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 17:01:46,056 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 2 time:  332.02975058555603
2026-01-20 17:07:16,583 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 17:07:16,683 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0054
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.013605 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.007143 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0 metrics: test on val accuracy 0.0500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0063
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.015873 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.008333 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 1 metrics: test on val accuracy 0.0500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 17:09:14,516 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 2 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_2_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.011905 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.006250 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.011904761904761904, 'precision': 0.125, 'recall': 0.00625, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.011904761904761904, 'std': 0.0, 'min': 0.011904761904761904, 'max': 0.011904761904761904, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.00625, 'std': 0.0, 'min': 0.00625, 'max': 0.00625, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.015873 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.008333 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.015873015873015872, 'precision': 0.16666666666666666, 'recall': 0.008333333333333333, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.015873015873015872, 'std': 0.0, 'min': 0.015873015873015872, 'max': 0.015873015873015872, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.16666666666666666, 'std': 0.0, 'min': 0.16666666666666666, 'max': 0.16666666666666666, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.008333333333333333, 'std': 0.0, 'min': 0.008333333333333333, 'max': 0.008333333333333333, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.38 (std: 0.00, min: 0.38 at index 0, max: 0.375000 at index 0)
task balanced_accuracy: 0.38 (std: 0.00, min: 0.38 at index 0, max: 0.375000 at index 0)
task f1_score: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.089286 at index 0)
task precision: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.076531 at index 0)
task recall: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.107143 at index 0)
task f1_score_weighted: 0.31 (std: 0.00, min: 0.31 at index 0, max: 0.312500 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.375, 'balanced_accuracy': 0.375, 'f1_score': 0.08928571428571429, 'precision': 0.07653061224489796, 'recall': 0.10714285714285714, 'f1_score_weighted': 0.3125}), 'accuracy': {'mean': 0.375, 'std': 0.0, 'min': 0.375, 'max': 0.375, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.375, 'std': 0.0, 'min': 0.375, 'max': 0.375, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.08928571428571429, 'std': 0.0, 'min': 0.08928571428571429, 'max': 0.08928571428571429, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.07653061224489796, 'std': 0.0, 'min': 0.07653061224489796, 'max': 0.07653061224489796, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.10714285714285714, 'std': 0.0, 'min': 0.10714285714285714, 'max': 0.10714285714285714, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3125, 'std': 0.0, 'min': 0.3125, 'max': 0.3125, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 3-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 17:10:37,739 - flcore.servers.serverA2V - WARNING - === Round 3 starting hook temporally disabled ===
2026-01-20 17:10:37,743 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 17:10:39,369 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 3 time:  354.8454213142395
2026-01-20 17:16:32,848 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 17:16:32,947 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0058
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 0 metrics: test on val accuracy 0.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0070
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.015873 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.008333 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 1 metrics: test on val accuracy 0.0500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 17:18:37,662 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 3 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_3_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.015873 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.008333 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.05, 'balanced_accuracy': 0.05, 'f1_score': 0.015873015873015872, 'precision': 0.16666666666666666, 'recall': 0.008333333333333333, 'f1_score_weighted': 0.09523809523809523}), 'accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.05, 'std': 0.0, 'min': 0.05, 'max': 0.05, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.015873015873015872, 'std': 0.0, 'min': 0.015873015873015872, 'max': 0.015873015873015872, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.16666666666666666, 'std': 0.0, 'min': 0.16666666666666666, 'max': 0.16666666666666666, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.008333333333333333, 'std': 0.0, 'min': 0.008333333333333333, 'max': 0.008333333333333333, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 4-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 17:19:59,079 - flcore.servers.serverA2V - WARNING - === Round 4 starting hook temporally disabled ===
2026-01-20 17:19:59,083 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 17:20:00,619 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 4 time:  325.2388777732849
2026-01-20 17:25:25,051 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 17:25:25,151 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0015
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0 metrics: test on val accuracy 1.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0083
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 1 metrics: test on val accuracy 0.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 17:27:22,602 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 4 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_4_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037267 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.021429 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.15, 'balanced_accuracy': 0.15, 'f1_score': 0.037267080745341616, 'precision': 0.14285714285714285, 'recall': 0.02142857142857143, 'f1_score_weighted': 0.2608695652173913}), 'accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.037267080745341616, 'std': 0.0, 'min': 0.037267080745341616, 'max': 0.037267080745341616, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.02142857142857143, 'std': 0.0, 'min': 0.02142857142857143, 'max': 0.02142857142857143, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2608695652173913, 'std': 0.0, 'min': 0.2608695652173913, 'max': 0.2608695652173913, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task balanced_accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.010101 at index 0)
task precision: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.055556 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.005556 at index 0)
task f1_score_weighted: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.045455 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.025, 'balanced_accuracy': 0.025, 'f1_score': 0.010101010101010102, 'precision': 0.05555555555555555, 'recall': 0.005555555555555556, 'f1_score_weighted': 0.045454545454545456}), 'accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.010101010101010102, 'std': 0.0, 'min': 0.010101010101010102, 'max': 0.010101010101010102, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.05555555555555555, 'std': 0.0, 'min': 0.05555555555555555, 'max': 0.05555555555555555, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.005555555555555556, 'std': 0.0, 'min': 0.005555555555555556, 'max': 0.005555555555555556, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.045454545454545456, 'std': 0.0, 'min': 0.045454545454545456, 'max': 0.045454545454545456, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 5-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 17:28:38,352 - flcore.servers.serverA2V - WARNING - === Round 5 starting hook temporally disabled ===
2026-01-20 17:28:38,356 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 17:28:39,582 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 5 time:  349.2038872241974
2026-01-20 17:34:27,790 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 17:34:27,938 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0034
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0 metrics: test on val accuracy 1.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0082
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 1 metrics: test on val accuracy 0.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 17:36:28,250 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 5 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_5_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.9, 'balanced_accuracy': 0.9, 'f1_score': 0.3157894736842105, 'precision': 0.3333333333333333, 'recall': 0.3, 'f1_score_weighted': 0.9473684210526315}), 'accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.3157894736842105, 'std': 0.0, 'min': 0.3157894736842105, 'max': 0.3157894736842105, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9473684210526315, 'std': 0.0, 'min': 0.9473684210526315, 'max': 0.9473684210526315, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task balanced_accuracy: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.011905 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.006250 at index 0)
task f1_score_weighted: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.025, 'balanced_accuracy': 0.025, 'f1_score': 0.011904761904761904, 'precision': 0.125, 'recall': 0.00625, 'f1_score_weighted': 0.047619047619047616}), 'accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.011904761904761904, 'std': 0.0, 'min': 0.011904761904761904, 'max': 0.011904761904761904, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.00625, 'std': 0.0, 'min': 0.00625, 'max': 0.00625, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.047619047619047616, 'std': 0.0, 'min': 0.047619047619047616, 'max': 0.047619047619047616, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 6-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 17:37:44,732 - flcore.servers.serverA2V - WARNING - === Round 6 starting hook temporally disabled ===
2026-01-20 17:37:44,736 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 17:37:46,108 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 6 time:  311.6064553260803
2026-01-20 17:42:56,605 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 17:42:56,704 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0021
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0 metrics: test on val accuracy 1.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0046
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.65 (std: 0.00, min: 0.65 at index 0, max: 0.650000 at index 0)
task balanced_accuracy: 0.65 (std: 0.00, min: 0.65 at index 0, max: 0.650000 at index 0)
task f1_score: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.196970 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.16 (std: 0.00, min: 0.16 at index 0, max: 0.162500 at index 0)
task f1_score_weighted: 0.79 (std: 0.00, min: 0.79 at index 0, max: 0.787879 at index 0)

Node 1 metrics: test on val accuracy 0.6500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 17:44:56,026 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 6 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_6_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.80 (std: 0.00, min: 0.80 at index 0, max: 0.800000 at index 0)
task balanced_accuracy: 0.80 (std: 0.00, min: 0.80 at index 0, max: 0.800000 at index 0)
task f1_score: 0.22 (std: 0.00, min: 0.22 at index 0, max: 0.222222 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score_weighted: 0.89 (std: 0.00, min: 0.89 at index 0, max: 0.888889 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.8, 'balanced_accuracy': 0.8, 'f1_score': 0.2222222222222222, 'precision': 0.25, 'recall': 0.2, 'f1_score_weighted': 0.888888888888889}), 'accuracy': {'mean': 0.8, 'std': 0.0, 'min': 0.8, 'max': 0.8, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.8, 'std': 0.0, 'min': 0.8, 'max': 0.8, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.2222222222222222, 'std': 0.0, 'min': 0.2222222222222222, 'max': 0.2222222222222222, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.888888888888889, 'std': 0.0, 'min': 0.888888888888889, 'max': 0.888888888888889, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task balanced_accuracy: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task f1_score: 0.23 (std: 0.00, min: 0.23 at index 0, max: 0.225989 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.170940 at index 0)
task recall: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task f1_score_weighted: 0.34 (std: 0.00, min: 0.34 at index 0, max: 0.338983 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.5, 'balanced_accuracy': 0.5, 'f1_score': 0.22598870056497175, 'precision': 0.17094017094017092, 'recall': 0.3333333333333333, 'f1_score_weighted': 0.3389830508474576}), 'accuracy': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.22598870056497175, 'std': 0.0, 'min': 0.22598870056497175, 'max': 0.22598870056497175, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.17094017094017092, 'std': 0.0, 'min': 0.17094017094017092, 'max': 0.17094017094017092, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3389830508474576, 'std': 0.0, 'min': 0.3389830508474576, 'max': 0.3389830508474576, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 7-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 17:46:18,582 - flcore.servers.serverA2V - WARNING - === Round 7 starting hook temporally disabled ===
2026-01-20 17:46:18,586 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 17:46:19,498 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 7 time:  336.3426320552826
2026-01-20 17:51:55,123 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 17:51:55,221 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0013
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0 metrics: test on val accuracy 1.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0064
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.030303 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.016667 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 1 metrics: test on val accuracy 0.1000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 17:53:55,009 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 7 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_7_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task balanced_accuracy: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task precision: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task recall: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)
task f1_score_weighted: 0.00 (std: 0.00, min: 0.00 at index 0, max: 0.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.0, 'balanced_accuracy': 0.0, 'f1_score': 0.0, 'precision': 0.0, 'recall': 0.0, 'f1_score_weighted': 0.0}), 'accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.0, 'std': 0.0, 'min': 0.0, 'max': 0.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task balanced_accuracy: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.075000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.027676 at index 0)
task precision: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.148148 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.016667 at index 0)
task f1_score_weighted: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.124542 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.075, 'balanced_accuracy': 0.07500000000000001, 'f1_score': 0.027676027676027677, 'precision': 0.14814814814814814, 'recall': 0.01666666666666667, 'f1_score_weighted': 0.12454212454212454}), 'accuracy': {'mean': 0.075, 'std': 0.0, 'min': 0.075, 'max': 0.075, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.07500000000000001, 'std': 0.0, 'min': 0.07500000000000001, 'max': 0.07500000000000001, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.027676027676027677, 'std': 0.0, 'min': 0.027676027676027677, 'max': 0.027676027676027677, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14814814814814814, 'std': 0.0, 'min': 0.14814814814814814, 'max': 0.14814814814814814, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01666666666666667, 'std': 0.0, 'min': 0.01666666666666667, 'max': 0.01666666666666667, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.12454212454212454, 'std': 0.0, 'min': 0.12454212454212454, 'max': 0.12454212454212454, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 8-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 17:55:15,993 - flcore.servers.serverA2V - WARNING - === Round 8 starting hook temporally disabled ===
2026-01-20 17:55:15,996 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 17:55:17,091 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 8 time:  299.18458461761475
2026-01-20 18:00:15,403 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 18:00:15,537 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0025
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task balanced_accuracy: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.011905 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.006250 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)

Node 0 metrics: test on val accuracy 0.0500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0038
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task balanced_accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task f1_score: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.177419 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.137500 at index 0)
task f1_score_weighted: 0.71 (std: 0.00, min: 0.71 at index 0, max: 0.709677 at index 0)

Node 1 metrics: test on val accuracy 0.5500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 18:02:05,972 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 8 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_8_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.028571 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.2, 'balanced_accuracy': 0.2, 'f1_score': 0.047619047619047616, 'precision': 0.14285714285714285, 'recall': 0.028571428571428574, 'f1_score_weighted': 0.3333333333333333}), 'accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.047619047619047616, 'std': 0.0, 'min': 0.047619047619047616, 'max': 0.047619047619047616, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.028571428571428574, 'std': 0.0, 'min': 0.028571428571428574, 'max': 0.028571428571428574, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.75 (std: 0.00, min: 0.75 at index 0, max: 0.750000 at index 0)
task balanced_accuracy: 0.75 (std: 0.00, min: 0.75 at index 0, max: 0.750000 at index 0)
task f1_score: 0.29 (std: 0.00, min: 0.29 at index 0, max: 0.285714 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score_weighted: 0.86 (std: 0.00, min: 0.86 at index 0, max: 0.857143 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.75, 'balanced_accuracy': 0.75, 'f1_score': 0.2857142857142857, 'precision': 0.3333333333333333, 'recall': 0.25, 'f1_score_weighted': 0.8571428571428571}), 'accuracy': {'mean': 0.75, 'std': 0.0, 'min': 0.75, 'max': 0.75, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.75, 'std': 0.0, 'min': 0.75, 'max': 0.75, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.2857142857142857, 'std': 0.0, 'min': 0.2857142857142857, 'max': 0.2857142857142857, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.8571428571428571, 'std': 0.0, 'min': 0.8571428571428571, 'max': 0.8571428571428571, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task balanced_accuracy: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.075000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.028571 at index 0)
task precision: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.042857 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.021429 at index 0)
task f1_score_weighted: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.075, 'balanced_accuracy': 0.075, 'f1_score': 0.028571428571428574, 'precision': 0.04285714285714286, 'recall': 0.02142857142857143, 'f1_score_weighted': 0.1}), 'accuracy': {'mean': 0.075, 'std': 0.0, 'min': 0.075, 'max': 0.075, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.075, 'std': 0.0, 'min': 0.075, 'max': 0.075, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.028571428571428574, 'std': 0.0, 'min': 0.028571428571428574, 'max': 0.028571428571428574, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.04285714285714286, 'std': 0.0, 'min': 0.04285714285714286, 'max': 0.04285714285714286, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.02142857142857143, 'std': 0.0, 'min': 0.02142857142857143, 'max': 0.02142857142857143, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 9-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 18:03:21,510 - flcore.servers.serverA2V - WARNING - === Round 9 starting hook temporally disabled ===
2026-01-20 18:03:21,514 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 18:03:22,897 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 9 time:  311.8101375102997
2026-01-20 18:08:33,514 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 18:08:33,614 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0037
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.055556 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.033333 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0 metrics: test on val accuracy 0.2000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0027
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 18:10:26,626 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 9 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_9_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.020202 at index 0)
task precision: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.111111 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.011111 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.1, 'balanced_accuracy': 0.1, 'f1_score': 0.020202020202020204, 'precision': 0.1111111111111111, 'recall': 0.011111111111111112, 'f1_score_weighted': 0.18181818181818182}), 'accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.1, 'std': 0.0, 'min': 0.1, 'max': 0.1, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.020202020202020204, 'std': 0.0, 'min': 0.020202020202020204, 'max': 0.020202020202020204, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.1111111111111111, 'std': 0.0, 'min': 0.1111111111111111, 'max': 0.1111111111111111, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.011111111111111112, 'std': 0.0, 'min': 0.011111111111111112, 'max': 0.011111111111111112, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.18181818181818182, 'std': 0.0, 'min': 0.18181818181818182, 'max': 0.18181818181818182, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.42 (std: 0.00, min: 0.42 at index 0, max: 0.425000 at index 0)
task balanced_accuracy: 0.42 (std: 0.00, min: 0.42 at index 0, max: 0.425000 at index 0)
task f1_score: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)
task precision: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.078341 at index 0)
task recall: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.121429 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.425, 'balanced_accuracy': 0.425, 'f1_score': 0.09523809523809523, 'precision': 0.07834101382488479, 'recall': 0.12142857142857143, 'f1_score_weighted': 0.3333333333333333}), 'accuracy': {'mean': 0.425, 'std': 0.0, 'min': 0.425, 'max': 0.425, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.425, 'std': 0.0, 'min': 0.425, 'max': 0.425, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.07834101382488479, 'std': 0.0, 'min': 0.07834101382488479, 'max': 0.07834101382488479, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.12142857142857143, 'std': 0.0, 'min': 0.12142857142857143, 'max': 0.12142857142857143, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 10-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-20 18:11:35,476 - flcore.servers.serverA2V - WARNING - === Round 10 starting hook temporally disabled ===
2026-01-20 18:11:35,480 - flcore.servers.serverA2V - INFO - Sending global adapters to node 0
2026-01-20 18:11:36,733 - flcore.servers.serverA2V - INFO - Sending global adapters to node 1
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
[]
--------------------------------------------------Round 10 time:  313.07119035720825
2026-01-20 18:16:48,850 - flcore.servers.serverA2V - INFO - Aggregated adapters from nodes [0, 1] using FedAvg.
2026-01-20 18:16:48,980 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0029
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0 metrics: test on val accuracy 1.0000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - ‚úì Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_0_20le_5gr_dog_val_19.png
‚úì Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0014
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - ‚úì Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_1_20le_5gr_chainsaw_val_19.png
‚úì Cleaned up memory after val split
2026-01-20 18:18:41,282 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping

Generating global images using aggregated adapters at round 10 on test split
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_0.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_1.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_2.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_3.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_4.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_5.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_6.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_7.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_8.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_9.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_10.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_11.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_12.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_13.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_14.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_15.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_16.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_17.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_18.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_dog_test_19.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_20.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_21.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_22.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_23.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_24.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_25.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_26.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_27.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_28.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_29.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_30.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_31.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_32.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_33.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_34.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_35.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_36.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_37.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_38.png
Saved generated image to output_images/vegas-2n-2c-200s-avg/round_10_node_server_20le_5gr_chainsaw_test_39.png
Generated and saved 40 global images using aggregated adapters
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
Generated images for split test: 40 samples.
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.055300 at index 0)
task precision: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.077922 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.042857 at index 0)
task f1_score_weighted: 0.19 (std: 0.00, min: 0.19 at index 0, max: 0.193548 at index 0)

Server
{'test': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.15, 'balanced_accuracy': 0.15, 'f1_score': 0.05529953917050691, 'precision': 0.07792207792207792, 'recall': 0.04285714285714286, 'f1_score_weighted': 0.1935483870967742}), 'accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.05529953917050691, 'std': 0.0, 'min': 0.05529953917050691, 'max': 0.05529953917050691, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.07792207792207792, 'std': 0.0, 'min': 0.07792207792207792, 'max': 0.07792207792207792, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.04285714285714286, 'std': 0.0, 'min': 0.04285714285714286, 'max': 0.04285714285714286, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.1935483870967742, 'std': 0.0, 'min': 0.1935483870967742, 'max': 0.1935483870967742, 'min_index': 0, 'max_index': 0}})}
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)

Average time cost: 5259.69s.
std for best accurancy: nan
mean for best accurancy: nan
All done!

