Wed Jan 21 10:38:23 AM UTC 2026
_CudaDeviceProperties(name='NVIDIA H100 80GB HBM3', major=9, minor=0, total_memory=81089MB, multi_processor_count=132, uuid=7d93d577-7507-86a4-722f-07fdc4b6905e, L2_cache_size=50MB)
0 0

Applied default for experiment.goal: test
Applied default for experiment.device: cuda
Applied default for experiment.device_id: 0
Applied default for experiment.runs: 1
Applied default for experiment.seed: -1
Applied default for experiment.optimize_memory: False
Applied default for experiment.debug: False
Applied default for federation.join_ratio: 1.0
Applied default for federation.generate_images_frequency: 0
Applied default for model.num_classes: 10
Applied default for model.embedding_size: 768
Applied default for model.patch_size: 16
Applied default for training.momentum: 0.9
Applied default for training.learning_rate_schedule: False
Applied default for dataset.image_size: -1
Applied default for dataset.transform: False
Applied default for dataset.partition: pat
Applied default for dataset.dir_alpha: 0.1
Applied default for dataset.balance: False
Applied default for rewind.epochs: 0
Applied default for rewind.ratio: 0.0
Applied default for rewind.interval: 0
Applied default for rewind.strategy: none
Applied default for fedgfe.nodes_datasets: cifar10
Applied default for fedgfe.nodes_downstream_tasks: none
Applied default for fedgfe.nodes_pretext_tasks: 
Applied default for fedgfe.nodes_training_sequence: both
Applied default for fedgfe.cls_token_only: False
Applied default for fedgfe.limit_samples_number: 0
Applied default for feda2v.diffusion_type: sd
Applied default for feda2v.use_act_loss: False
Applied default for feda2v.use_text_loss: True
Applied default for feda2v.use_image_loss: False
Applied default for feda2v.audio_model_name: MIT/ast-finetuned-audioset-10-10-0.4593
Applied default for feda2v.image_model_name: google/vit-base-patch16-224-in21k
Applied default for feda2v.img_pipe_name: runwayml/stable-diffusion-v1-5
Applied default for feda2v.img_lcm_lora_id: latent-consistency/lcm-lora-sdv1-5
Applied default for feda2v.audio_pipe_name: cvssp/audioldm-l-full
Applied default for feda2v.steps: 1000
Applied default for feda2v.mode: train_nodata
Applied default for feda2v.ablation_type: only_t5
Applied default for feda2v.controllability_type: volume
Applied default for feda2v.target_img_path: data/img
Applied default for feda2v.img_out_path: exp/img
Applied default for feda2v.audio_out_path: exp/audio
Applied default for feda2v.class_to_activate: 8
Applied default for feda2v.single_class: False
Applied default for feda2v.checkpoint_name: best_model
Applied default for feda2v.project: sinestesia
Applied default for feda2v.entity: ctlab-team
Applied default for feda2v.wandb_mode: offline
Applied default for feda2v.global_model_train_from_generator: False
Applied default for feda2v.global_model_train_from_nodes_audio_embeddings: False
Applied default for feda2v.global_model_train_inputs: none
Applied default for feda2v.adapter_aggregation_method: none
Applied default for feda2v.text_losses_summed: False
Applied default for feda2v.compute_global_mean_from_class_means: False
Applied default for feda2v.generation_split_for_metrics: ['test', 'val']
Applied default for feda2v.synthetic_samples_per_class: auto
Applied default for feda2v.reset_generator_on_class_change: True
Applied default for feda2v.shared_generator_in_only_mode: True
Applied default for nodes.0.dataset_split: all
Applied default for nodes.0.pretext_tasks: []
Applied default for nodes.0.task_type: classification
Applied default for nodes.0.balance_classes: False
Applied default for nodes.0.use_folds: False
Applied default for nodes.0.train_folds: [0, 1, 2, 3]
Applied default for nodes.0.test_folds: [4]
Applied default for nodes.1.dataset_split: all
Applied default for nodes.1.pretext_tasks: []
Applied default for nodes.1.task_type: classification
Applied default for nodes.1.balance_classes: False
Applied default for nodes.1.use_folds: False
Applied default for nodes.1.train_folds: [0, 1, 2, 3]
Applied default for nodes.1.test_folds: [4]
Warning: Could not map class label 'dog' to numeric index
Node 0: Selected classes ['dog'] -> []
Warning: Could not map class label 'chainsaw' to numeric index
Node 1: Selected classes ['chainsaw'] -> []
Set num_clients: 2
Successfully loaded configuration from: configs/a2v_vegas_2n_2c_200s_train_adapters.json
Using nodes_tasks from config file (already processed)
==================================================
Algorithm: FedA2V
Local batch size: 8
Local epochs: 20
Local learing rate: 0.001
Local learing rate schedule: False
Total number of clients: 2
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: VEGAS
Number of classes: 10
Backbone: a2v
Using device: cuda
Using DP: False
Auto break: False
Global rounds: 10
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
A2V G model sd

============= Running time: 0th =============
Creating server and clients ...
None
Enabling wandb to progect:  FedA2V
Finished creating server and clients.
2026-01-21 10:38:35,747 - utils.ballooning - INFO - Initialized GPUMemoryBalloon for GPU 0
2026-01-21 10:38:35,987 - utils.ballooning - INFO - GPU 0: Total memory: 81089 MB, Free before: 80563 MB, Target reserve: 0 MB
2026-01-21 10:38:35,987 - utils.ballooning - INFO - GPU 0: Successfully allocated 0 MB. Free memory: 80563 MB -> 80563 MB
2026-01-21 10:38:37,322 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - Initializing AST model: MIT/ast-finetuned-audioset-10-10-0.4593
2026-01-21 10:38:37,942 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - AST model initialized successfully
Started diffusion model flux
Creating 0 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['dog']
2026-01-21 10:38:42,757 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-21 10:38:42,757 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-21 10:38:42,945 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:42,946 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:43,125 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:43,125 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:43,127 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 180 samples, classes: ['dog'], split: train
2026-01-21 10:38:43,128 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-21 10:38:43,312 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:43,313 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:43,491 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:43,492 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:43,494 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['dog'], split: val
2026-01-21 10:38:43,494 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-21 10:38:43,689 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:43,689 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:43,867 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:43,867 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:43,869 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 0 samples, classes: ['dog'], split: test
2026-01-21 10:38:43,869 - datautils.dataset_vegas - INFO - Auto-split created: train=180, val=20, test=0
2026-01-21 10:38:44,046 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:44,047 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:44,225 - datautils.dataset_vegas - INFO - Node split 0 - Class dog: 200 samples (requested: 200)
2026-01-21 10:38:44,226 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:44,227 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['dog'], split: None
Stratified split: train=180, val=20, test=0
Trying to set schdulers but no optimizer for client  0
2026-01-21 10:38:46,421 - flcore.clients.clientA2V - INFO - Node 0: Using global use_cls_token_only=False
2026-01-21 10:38:47,370 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-21 10:38:47,370 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-21 10:38:47,372 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=180, val=20, test=0
[Client 0] Auto-calculated synthetic_samples_per_class = 180 (total samples: 180, classes: 1)
Creating 1 Audio2Visual node from nodes_tasks configuration:, using dataset VEGAS and labels ['chainsaw']
2026-01-21 10:38:51,731 - datautils.dataset_vegas - INFO - Auto-creating train/val/test splits (split=None)
2026-01-21 10:38:51,731 - datautils.dataset_vegas - INFO - Creating train split...
2026-01-21 10:38:51,858 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:51,859 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:51,980 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:51,980 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:51,983 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 180 samples, classes: ['chainsaw'], split: train
2026-01-21 10:38:51,983 - datautils.dataset_vegas - INFO - Creating validation split...
2026-01-21 10:38:52,111 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:52,111 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:52,230 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:52,231 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:52,233 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 20 samples, classes: ['chainsaw'], split: val
2026-01-21 10:38:52,233 - datautils.dataset_vegas - INFO - Creating test split...
2026-01-21 10:38:52,360 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:52,361 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:52,479 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:52,480 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:52,481 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 0 samples, classes: ['chainsaw'], split: test
2026-01-21 10:38:52,481 - datautils.dataset_vegas - INFO - Auto-split created: train=180, val=20, test=0
2026-01-21 10:38:52,599 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:52,599 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:52,718 - datautils.dataset_vegas - INFO - Node split 0 - Class chainsaw: 200 samples (requested: 200)
2026-01-21 10:38:52,718 - datautils.dataset_vegas - INFO - Node split 0 total samples after split: 200
2026-01-21 10:38:52,720 - datautils.dataset_vegas - INFO - VEGAS Dataset initialized: 200 samples, classes: ['chainsaw'], split: None
Stratified split: train=180, val=20, test=0
Trying to set schdulers but no optimizer for client  1
2026-01-21 10:38:54,751 - flcore.clients.clientA2V - INFO - Node 1: Using global use_cls_token_only=False
2026-01-21 10:38:55,760 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
2026-01-21 10:38:55,761 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - SKIPPING AST INITIALIZATION - Using pretrained generators mode or disabled by constructor
2026-01-21 10:38:55,761 - flcore.trainmodel.downstreamsinestesiaadapters - INFO - ================================================================================
Stratified split: train=180, val=20, test=0
[Client 1] Auto-calculated synthetic_samples_per_class = 180 (total samples: 180, classes: 1)
Created server test dataset with 0 samples from 2 nodes
2026-01-21 10:39:00,125 - flcore.servers.serverA2V - INFO - [Server] Auto-calculating synthetic_samples_per_class for each node and class
2026-01-21 10:39:00,125 - flcore.servers.serverA2V - INFO - [Server] Node 0: 180 synthetic samples/class (total samples: 180, classes: 1)
2026-01-21 10:39:00,125 - flcore.servers.serverA2V - INFO - [Server] Node 1: 180 synthetic samples/class (total samples: 180, classes: 1)
2026-01-21 10:39:00,125 - flcore.servers.serverA2V - INFO - [Server] Average synthetic_samples_per_class = 180

*** Client 0 dataset VEGAS
2026-01-21 10:39:00,125 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.

*** Client 1 dataset VEGAS
2026-01-21 10:39:00,125 - flcore.servers.serverA2V - WARNING - Skipping dataset details for VEGASDataset to avoid long logs.
2026-01-21 10:39:00,127 - flcore.servers.serverA2V - INFO - Finished creating Audio2Visual server and clients.

-------------Round number: 1-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 10:39:00,400 - flcore.servers.serverA2V - WARNING - === Round 1 starting hook temporally disabled ===
Creating dataloader for train dataset for client 0 with 180 samples
Creating dataloader for test dataset for client 0 with 0 samples
Creating optimizer for node 0 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 0
Node 0: No optimizer initialized
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 0] âš ï¸  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

ğŸ“Š MEMORY SUMMARY:
  Start:  Allocated=3.89 GB, Reserved=4.03 GB (5.1%)
  End:    Allocated=6.70 GB, Reserved=7.99 GB (10.1%)
  Growth: Allocated=+2.817 GB, Reserved=+3.959 GB

ğŸ“ˆ PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Î” Alloc         Î” Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          6.70 GB            7.99 GB          +2.816 GB     +3.959 GB     0.8215
2          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.2016
3          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0364
4          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0120
5          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0104
6          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0094
7          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0090
8          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0087
9          6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0085
10         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0085
11         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
12         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
13         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
14         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
15         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
16         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
17         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
18         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
19         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084
20         6.70 GB            7.99 GB          +2.817 GB     +3.959 GB     0.0084

  ğŸ”´ Max growth at Epoch 1: +3.959 GB reserved
====================================================================================================

2026-01-21 10:40:49,651 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 1
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_1_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_1_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_1_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_1_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Creating dataloader for train dataset for client 1 with 180 samples
Creating dataloader for test dataset for client 1 with 0 samples
Creating optimizer for node 1 with model optimizer AdamW and learning rate 0.001
Creating learning rate scheduler for node 1
Node 1: No optimizer initialized
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples

====================================================================================================
[Node 1] âš ï¸  MEMORY GROWTH DETECTED - Round 1
====================================================================================================

ğŸ“Š MEMORY SUMMARY:
  Start:  Allocated=3.39 GB, Reserved=3.48 GB (4.4%)
  End:    Allocated=6.14 GB, Reserved=7.22 GB (9.1%)
  Growth: Allocated=+2.754 GB, Reserved=+3.748 GB

ğŸ“ˆ PER-EPOCH BREAKDOWN:
Epoch    Allocated (GB)       Reserved (GB)        Î” Alloc         Î” Reserved      Avg Loss    
-------- -------------------- -------------------- --------------- --------------- ------------
1          6.14 GB            6.87 GB          +2.755 GB     +3.396 GB     0.8466
2          6.14 GB            7.22 GB          +2.755 GB     +3.748 GB     0.2125
3          6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0407
4          6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0137
5          6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0116
6          6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0107
7          6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0101
8          6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0098
9          6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0097
10         6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0096
11         6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0096
12         6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0095
13         6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0095
14         6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0095
15         6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0095
16         6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0095
17         6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0095
18         6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0094
19         6.14 GB            7.12 GB          +2.754 GB     +3.646 GB     0.0094
20         6.14 GB            7.22 GB          +2.754 GB     +3.748 GB     0.0094

  ğŸ”´ Max growth at Epoch 2: +3.748 GB reserved
====================================================================================================

2026-01-21 10:43:31,322 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 1
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_1_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_1_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_1_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_1_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 1 time:  331.192284822464
2026-01-21 10:44:31,592 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.047619 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.028571 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0 metrics: test on val accuracy 0.2000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0048
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1 metrics: test on val accuracy 0.9000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_1_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 10:46:28,322 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.05714285714285715, 'precision': 0.14285714285714285, 'recall': 0.03571428571428571, 'f1_score_weighted': 0.4}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.05714285714285715, 'std': 0.0, 'min': 0.05714285714285715, 'max': 0.05714285714285715, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03571428571428571, 'std': 0.0, 'min': 0.03571428571428571, 'max': 0.03571428571428571, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task balanced_accuracy: 0.90 (std: 0.00, min: 0.90 at index 0, max: 0.900000 at index 0)
task f1_score: 0.32 (std: 0.00, min: 0.32 at index 0, max: 0.315789 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score_weighted: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.947368 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.9, 'balanced_accuracy': 0.9, 'f1_score': 0.3157894736842105, 'precision': 0.3333333333333333, 'recall': 0.3, 'f1_score_weighted': 0.9473684210526315}), 'accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.9, 'std': 0.0, 'min': 0.9, 'max': 0.9, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.3157894736842105, 'std': 0.0, 'min': 0.3157894736842105, 'max': 0.3157894736842105, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.9473684210526315, 'std': 0.0, 'min': 0.9473684210526315, 'max': 0.9473684210526315, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 2-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 10:46:59,193 - flcore.servers.serverA2V - WARNING - === Round 2 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 10:48:38,799 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 2
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_2_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_2_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_2_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_2_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 10:51:17,590 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 2
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_2_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_2_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_2_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_2_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 2 time:  327.45250248908997
2026-01-21 10:52:26,645 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.065934 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.042857 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 0 metrics: test on val accuracy 0.3000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0050
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.066667 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.041667 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 1 metrics: test on val accuracy 0.2500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_2_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 10:54:24,752 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037267 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.021429 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.15, 'balanced_accuracy': 0.15, 'f1_score': 0.037267080745341616, 'precision': 0.14285714285714285, 'recall': 0.02142857142857143, 'f1_score_weighted': 0.2608695652173913}), 'accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.037267080745341616, 'std': 0.0, 'min': 0.037267080745341616, 'max': 0.037267080745341616, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.02142857142857143, 'std': 0.0, 'min': 0.02142857142857143, 'max': 0.02142857142857143, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2608695652173913, 'std': 0.0, 'min': 0.2608695652173913, 'max': 0.2608695652173913, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task balanced_accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task f1_score: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.095238 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.07 (std: 0.00, min: 0.07 at index 0, max: 0.066667 at index 0)
task f1_score_weighted: 0.57 (std: 0.00, min: 0.57 at index 0, max: 0.571429 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.4, 'balanced_accuracy': 0.4, 'f1_score': 0.09523809523809523, 'precision': 0.16666666666666666, 'recall': 0.06666666666666667, 'f1_score_weighted': 0.5714285714285714}), 'accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.09523809523809523, 'std': 0.0, 'min': 0.09523809523809523, 'max': 0.09523809523809523, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.16666666666666666, 'std': 0.0, 'min': 0.16666666666666666, 'max': 0.16666666666666666, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.06666666666666667, 'std': 0.0, 'min': 0.06666666666666667, 'max': 0.06666666666666667, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.5714285714285714, 'std': 0.0, 'min': 0.5714285714285714, 'max': 0.5714285714285714, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 3-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 10:54:55,313 - flcore.servers.serverA2V - WARNING - === Round 3 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 10:56:41,692 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 3
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_3_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_3_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_3_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_3_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 10:59:29,843 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 3
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_3_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_3_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_3_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_3_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 3 time:  331.00079011917114
2026-01-21 11:00:26,313 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025974 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.014286 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0 metrics: test on val accuracy 0.1000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0050
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_3_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:02:21,861 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task balanced_accuracy: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task f1_score: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.111111 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.083333 at index 0)
task f1_score_weighted: 0.67 (std: 0.00, min: 0.67 at index 0, max: 0.666667 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.5, 'balanced_accuracy': 0.5, 'f1_score': 0.1111111111111111, 'precision': 0.16666666666666666, 'recall': 0.08333333333333333, 'f1_score_weighted': 0.6666666666666666}), 'accuracy': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.5, 'std': 0.0, 'min': 0.5, 'max': 0.5, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.1111111111111111, 'std': 0.0, 'min': 0.1111111111111111, 'max': 0.1111111111111111, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.16666666666666666, 'std': 0.0, 'min': 0.16666666666666666, 'max': 0.16666666666666666, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.08333333333333333, 'std': 0.0, 'min': 0.08333333333333333, 'max': 0.08333333333333333, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.6666666666666666, 'std': 0.0, 'min': 0.6666666666666666, 'max': 0.6666666666666666, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.85 (std: 0.00, min: 0.85 at index 0, max: 0.850000 at index 0)
task balanced_accuracy: 0.85 (std: 0.00, min: 0.85 at index 0, max: 0.850000 at index 0)
task f1_score: 0.23 (std: 0.00, min: 0.23 at index 0, max: 0.229730 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.21 (std: 0.00, min: 0.21 at index 0, max: 0.212500 at index 0)
task f1_score_weighted: 0.92 (std: 0.00, min: 0.92 at index 0, max: 0.918919 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.85, 'balanced_accuracy': 0.85, 'f1_score': 0.22972972972972974, 'precision': 0.25, 'recall': 0.2125, 'f1_score_weighted': 0.918918918918919}), 'accuracy': {'mean': 0.85, 'std': 0.0, 'min': 0.85, 'max': 0.85, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.85, 'std': 0.0, 'min': 0.85, 'max': 0.85, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.22972972972972974, 'std': 0.0, 'min': 0.22972972972972974, 'max': 0.22972972972972974, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.2125, 'std': 0.0, 'min': 0.2125, 'max': 0.2125, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.918918918918919, 'std': 0.0, 'min': 0.918918918918919, 'max': 0.918918918918919, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 4-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 11:02:52,930 - flcore.servers.serverA2V - WARNING - === Round 4 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:04:28,950 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 4
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_4_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_4_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_4_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_4_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:07:08,261 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 4
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_4_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_4_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_4_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_4_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 4 time:  312.1833486557007
2026-01-21 11:08:05,113 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.041667 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0 metrics: test on val accuracy 0.2000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0065
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.70 (std: 0.00, min: 0.70 at index 0, max: 0.700000 at index 0)
task balanced_accuracy: 0.70 (std: 0.00, min: 0.70 at index 0, max: 0.700000 at index 0)
task f1_score: 0.21 (std: 0.00, min: 0.21 at index 0, max: 0.205882 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.175000 at index 0)
task f1_score_weighted: 0.82 (std: 0.00, min: 0.82 at index 0, max: 0.823529 at index 0)

Node 1 metrics: test on val accuracy 0.7000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_4_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:09:58,007 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task balanced_accuracy: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.041667 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.025000 at index 0)
task f1_score_weighted: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.2, 'balanced_accuracy': 0.2, 'f1_score': 0.041666666666666664, 'precision': 0.125, 'recall': 0.025, 'f1_score_weighted': 0.3333333333333333}), 'accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.041666666666666664, 'std': 0.0, 'min': 0.041666666666666664, 'max': 0.041666666666666664, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.025, 'std': 0.0, 'min': 0.025, 'max': 0.025, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.80 (std: 0.00, min: 0.80 at index 0, max: 0.800000 at index 0)
task balanced_accuracy: 0.80 (std: 0.00, min: 0.80 at index 0, max: 0.800000 at index 0)
task f1_score: 0.22 (std: 0.00, min: 0.22 at index 0, max: 0.222222 at index 0)
task precision: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task recall: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task f1_score_weighted: 0.89 (std: 0.00, min: 0.89 at index 0, max: 0.888889 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.8, 'balanced_accuracy': 0.8, 'f1_score': 0.2222222222222222, 'precision': 0.25, 'recall': 0.2, 'f1_score_weighted': 0.888888888888889}), 'accuracy': {'mean': 0.8, 'std': 0.0, 'min': 0.8, 'max': 0.8, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.8, 'std': 0.0, 'min': 0.8, 'max': 0.8, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.2222222222222222, 'std': 0.0, 'min': 0.2222222222222222, 'max': 0.2222222222222222, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.888888888888889, 'std': 0.0, 'min': 0.888888888888889, 'max': 0.888888888888889, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 5-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 11:10:29,201 - flcore.servers.serverA2V - WARNING - === Round 5 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:12:08,122 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 5
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_5_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_5_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_5_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_5_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:14:37,173 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 5
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_5_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_5_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_5_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_5_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 5 time:  307.55354928970337
2026-01-21 11:15:36,754 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task balanced_accuracy: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task f1_score: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.022727 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.01 (std: 0.00, min: 0.01 at index 0, max: 0.012500 at index 0)
task f1_score_weighted: 0.18 (std: 0.00, min: 0.18 at index 0, max: 0.181818 at index 0)

Node 0 metrics: test on val accuracy 0.1000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0065
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task balanced_accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task f1_score: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.118280 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.09 (std: 0.00, min: 0.09 at index 0, max: 0.091667 at index 0)
task f1_score_weighted: 0.71 (std: 0.00, min: 0.71 at index 0, max: 0.709677 at index 0)

Node 1 metrics: test on val accuracy 0.5500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_5_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:17:32,275 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.032609 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.018750 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.15, 'balanced_accuracy': 0.15, 'f1_score': 0.03260869565217391, 'precision': 0.125, 'recall': 0.01875, 'f1_score_weighted': 0.2608695652173913}), 'accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.03260869565217391, 'std': 0.0, 'min': 0.03260869565217391, 'max': 0.03260869565217391, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.01875, 'std': 0.0, 'min': 0.01875, 'max': 0.01875, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2608695652173913, 'std': 0.0, 'min': 0.2608695652173913, 'max': 0.2608695652173913, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task balanced_accuracy: 0.55 (std: 0.00, min: 0.55 at index 0, max: 0.550000 at index 0)
task f1_score: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.141935 at index 0)
task precision: 0.20 (std: 0.00, min: 0.20 at index 0, max: 0.200000 at index 0)
task recall: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.110000 at index 0)
task f1_score_weighted: 0.71 (std: 0.00, min: 0.71 at index 0, max: 0.709677 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.55, 'balanced_accuracy': 0.55, 'f1_score': 0.14193548387096774, 'precision': 0.2, 'recall': 0.11000000000000001, 'f1_score_weighted': 0.7096774193548387}), 'accuracy': {'mean': 0.55, 'std': 0.0, 'min': 0.55, 'max': 0.55, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.55, 'std': 0.0, 'min': 0.55, 'max': 0.55, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.14193548387096774, 'std': 0.0, 'min': 0.14193548387096774, 'max': 0.14193548387096774, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.2, 'std': 0.0, 'min': 0.2, 'max': 0.2, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.11000000000000001, 'std': 0.0, 'min': 0.11000000000000001, 'max': 0.11000000000000001, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.7096774193548387, 'std': 0.0, 'min': 0.7096774193548387, 'max': 0.7096774193548387, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 6-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 11:18:03,664 - flcore.servers.serverA2V - WARNING - === Round 6 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:19:41,271 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 6
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_6_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_6_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_6_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_6_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:22:15,553 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 6
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_6_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_6_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_6_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_6_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 6 time:  309.00403332710266
2026-01-21 11:23:12,668 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.032609 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.018750 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0 metrics: test on val accuracy 0.1500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0021
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_6_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:25:06,258 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.05714285714285715, 'precision': 0.14285714285714285, 'recall': 0.03571428571428571, 'f1_score_weighted': 0.4}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.05714285714285715, 'std': 0.0, 'min': 0.05714285714285715, 'max': 0.05714285714285715, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03571428571428571, 'std': 0.0, 'min': 0.03571428571428571, 'max': 0.03571428571428571, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 7-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 11:25:30,450 - flcore.servers.serverA2V - WARNING - === Round 7 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:27:13,343 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 7
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_7_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_7_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_7_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_7_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:29:48,334 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 7
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_7_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_7_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_7_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_7_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 7 time:  312.24429535865784
2026-01-21 11:30:42,693 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.03 (std: 0.00, min: 0.03 at index 0, max: 0.032609 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.018750 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0 metrics: test on val accuracy 0.1500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0007
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_7_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:32:35,198 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.05714285714285715, 'precision': 0.14285714285714285, 'recall': 0.03571428571428571, 'f1_score_weighted': 0.4}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.05714285714285715, 'std': 0.0, 'min': 0.05714285714285715, 'max': 0.05714285714285715, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03571428571428571, 'std': 0.0, 'min': 0.03571428571428571, 'max': 0.03571428571428571, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 8-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 11:32:58,281 - flcore.servers.serverA2V - WARNING - === Round 8 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:34:37,179 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 8
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_8_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_8_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_8_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_8_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:37:10,932 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 8
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_8_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_8_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_8_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_8_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 8 time:  309.74859499931335
2026-01-21 11:38:08,030 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task balanced_accuracy: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.10 (std: 0.00, min: 0.10 at index 0, max: 0.100000 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.040000 at index 0)
task f1_score_weighted: 0.57 (std: 0.00, min: 0.57 at index 0, max: 0.571429 at index 0)

Node 0 metrics: test on val accuracy 0.4000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0010
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_8_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:39:59,510 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task balanced_accuracy: 0.15 (std: 0.00, min: 0.15 at index 0, max: 0.150000 at index 0)
task f1_score: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037267 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.02 (std: 0.00, min: 0.02 at index 0, max: 0.021429 at index 0)
task f1_score_weighted: 0.26 (std: 0.00, min: 0.26 at index 0, max: 0.260870 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.15, 'balanced_accuracy': 0.15, 'f1_score': 0.037267080745341616, 'precision': 0.14285714285714285, 'recall': 0.02142857142857143, 'f1_score_weighted': 0.2608695652173913}), 'accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.15, 'std': 0.0, 'min': 0.15, 'max': 0.15, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.037267080745341616, 'std': 0.0, 'min': 0.037267080745341616, 'max': 0.037267080745341616, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.02142857142857143, 'std': 0.0, 'min': 0.02142857142857143, 'max': 0.02142857142857143, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.2608695652173913, 'std': 0.0, 'min': 0.2608695652173913, 'max': 0.2608695652173913, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 9-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 11:40:20,493 - flcore.servers.serverA2V - WARNING - === Round 9 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:41:58,726 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 9
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_9_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_9_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_9_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_9_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:44:40,550 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 9
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_9_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_9_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_9_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_9_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 9 time:  309.1561028957367
2026-01-21 11:45:29,649 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task balanced_accuracy: 0.35 (std: 0.00, min: 0.35 at index 0, max: 0.350000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057613 at index 0)
task precision: 0.11 (std: 0.00, min: 0.11 at index 0, max: 0.111111 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.038889 at index 0)
task f1_score_weighted: 0.52 (std: 0.00, min: 0.52 at index 0, max: 0.518519 at index 0)

Node 0 metrics: test on val accuracy 0.3500

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0038
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task balanced_accuracy: 0.95 (std: 0.00, min: 0.95 at index 0, max: 0.950000 at index 0)
task f1_score: 0.49 (std: 0.00, min: 0.49 at index 0, max: 0.487179 at index 0)
task precision: 0.50 (std: 0.00, min: 0.50 at index 0, max: 0.500000 at index 0)
task recall: 0.47 (std: 0.00, min: 0.47 at index 0, max: 0.475000 at index 0)
task f1_score_weighted: 0.97 (std: 0.00, min: 0.97 at index 0, max: 0.974359 at index 0)

Node 1 metrics: test on val accuracy 0.9500

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_9_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:47:26,019 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057692 at index 0)
task precision: 0.12 (std: 0.00, min: 0.12 at index 0, max: 0.125000 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.037500 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.3, 'balanced_accuracy': 0.3, 'f1_score': 0.057692307692307696, 'precision': 0.125, 'recall': 0.0375, 'f1_score_weighted': 0.46153846153846156}), 'accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.3, 'std': 0.0, 'min': 0.3, 'max': 0.3, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.057692307692307696, 'std': 0.0, 'min': 0.057692307692307696, 'max': 0.057692307692307696, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.125, 'std': 0.0, 'min': 0.125, 'max': 0.125, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.0375, 'std': 0.0, 'min': 0.0375, 'max': 0.0375, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.46153846153846156, 'std': 0.0, 'min': 0.46153846153846156, 'max': 0.46153846153846156, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 0.85 (std: 0.00, min: 0.85 at index 0, max: 0.850000 at index 0)
task balanced_accuracy: 0.85 (std: 0.00, min: 0.85 at index 0, max: 0.850000 at index 0)
task f1_score: 0.31 (std: 0.00, min: 0.31 at index 0, max: 0.306306 at index 0)
task precision: 0.33 (std: 0.00, min: 0.33 at index 0, max: 0.333333 at index 0)
task recall: 0.28 (std: 0.00, min: 0.28 at index 0, max: 0.283333 at index 0)
task f1_score_weighted: 0.92 (std: 0.00, min: 0.92 at index 0, max: 0.918919 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.85, 'balanced_accuracy': 0.85, 'f1_score': 0.30630630630630634, 'precision': 0.3333333333333333, 'recall': 0.2833333333333333, 'f1_score_weighted': 0.918918918918919}), 'accuracy': {'mean': 0.85, 'std': 0.0, 'min': 0.85, 'max': 0.85, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.85, 'std': 0.0, 'min': 0.85, 'max': 0.85, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.30630630630630634, 'std': 0.0, 'min': 0.30630630630630634, 'max': 0.30630630630630634, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.3333333333333333, 'std': 0.0, 'min': 0.3333333333333333, 'max': 0.3333333333333333, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.2833333333333333, 'std': 0.0, 'min': 0.2833333333333333, 'max': 0.2833333333333333, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.918918918918919, 'std': 0.0, 'min': 0.918918918918919, 'max': 0.918918918918919, 'min_index': 0, 'max_index': 0}})}

-------------Round number: 10-------------

Evaluate Audio2Visual models
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)
2026-01-21 11:47:45,842 - flcore.servers.serverA2V - WARNING - === Round 10 starting hook temporally disabled ===
Node 0 training Audio2Visual model for 20 epochs
Node 0 - Computing mean adapter outputs per class from training data
Node 0 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:49:30,781 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 0 at round 10
[Client 0] Saved clip_adapter to vegas-2n-2c-200s_node0_clip_adapter_round_10_class_dog.pt
[Client 0] Saved clip_projection to vegas-2n-2c-200s_node0_clip_projection_round_10_class_dog.pt
[Client 0] Saved t5_adapter to vegas-2n-2c-200s_node0_t5_adapter_round_10_class_dog.pt
[Client 0] Saved t5_projection to vegas-2n-2c-200s_node0_t5_projection_round_10_class_dog.pt

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 training Audio2Visual model for 20 epochs
Node 1 - Computing mean adapter outputs per class from training data
Node 1 - Stored outputs for 0 classes, 0 adapters, 0 total samples
2026-01-21 11:52:19,070 - flcore.servers.serverA2V - INFO - Saving adapter checkpoint for node 1 at round 10
[Client 1] Saved clip_adapter to vegas-2n-2c-200s_node1_clip_adapter_round_10_class_chainsaw.pt
[Client 1] Saved clip_projection to vegas-2n-2c-200s_node1_clip_projection_round_10_class_chainsaw.pt
[Client 1] Saved t5_adapter to vegas-2n-2c-200s_node1_t5_adapter_round_10_class_chainsaw.pt
[Client 1] Saved t5_projection to vegas-2n-2c-200s_node1_t5_projection_round_10_class_chainsaw.pt

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
[]
--------------------------------------------------Round 10 time:  323.27360820770264
2026-01-21 11:53:09,115 - utils.ballooning - INFO - GPU 0: No memory to release
Node 0 metrics: train on train text_loss 0.0042
Client 0: Generating images from split 'val' for metrics computation

Client 0: Generating images from val split using server's diffusion model
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_0.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_1.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_2.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_3.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_4.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_5.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_6.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_7.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_8.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_9.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_10.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_11.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_12.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_13.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_14.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_15.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_16.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_17.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_18.png
Client 0: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_19.png
Client 0: Generated 20 images from val split
task accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task balanced_accuracy: 0.30 (std: 0.00, min: 0.30 at index 0, max: 0.300000 at index 0)
task f1_score: 0.08 (std: 0.00, min: 0.08 at index 0, max: 0.076923 at index 0)
task precision: 0.17 (std: 0.00, min: 0.17 at index 0, max: 0.166667 at index 0)
task recall: 0.05 (std: 0.00, min: 0.05 at index 0, max: 0.050000 at index 0)
task f1_score_weighted: 0.46 (std: 0.00, min: 0.46 at index 0, max: 0.461538 at index 0)

Node 0 metrics: test on val accuracy 0.3000

Generating images for Node 0 using Audio2Visual model.
Generating images for split: val
Node 0 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 0 - âœ“ Retrieved 20 audio embeddings from dataset
Node 0 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_0_20le_10gr_dog_val_19.png
âœ“ Cleaned up memory after val split
Node 1 metrics: train on train text_loss 0.0013
Client 1: Generating images from split 'val' for metrics computation

Client 1: Generating images from val split using server's diffusion model
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_0.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_1.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_2.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_3.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_4.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_5.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_6.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_7.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_8.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_9.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_10.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_11.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_12.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_13.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_14.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_15.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_16.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_17.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_18.png
Client 1: Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_19.png
Client 1: Generated 20 images from val split
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1 metrics: test on val accuracy 1.0000

Generating images for Node 1 using Audio2Visual model.
Generating images for split: val
Node 1 - Processing 3 batches from dataset...
  Progress: 3/3 batches processed, 20 total samples
Node 1 - âœ“ Retrieved 20 audio embeddings from dataset
Node 1 - Embedding shapes: clip: torch.Size([20, 768]), t5: torch.Size([20, 17, 4096])
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_0.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_1.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_2.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_3.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_4.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_5.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_6.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_7.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_8.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_9.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_10.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_11.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_12.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_13.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_14.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_15.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_16.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_17.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_18.png
Saved generated image to output_images/vegas-2n-2c-200s-train-adapters/round_10_node_1_20le_10gr_chainsaw_val_19.png
âœ“ Cleaned up memory after val split
2026-01-21 11:55:03,127 - utils.ballooning - INFO - GPU 0: Balloon already inflated, skipping
Generated images for split val: 20 samples.
task accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task balanced_accuracy: 0.25 (std: 0.00, min: 0.25 at index 0, max: 0.250000 at index 0)
task f1_score: 0.06 (std: 0.00, min: 0.06 at index 0, max: 0.057143 at index 0)
task precision: 0.14 (std: 0.00, min: 0.14 at index 0, max: 0.142857 at index 0)
task recall: 0.04 (std: 0.00, min: 0.04 at index 0, max: 0.035714 at index 0)
task f1_score_weighted: 0.40 (std: 0.00, min: 0.40 at index 0, max: 0.400000 at index 0)

Node 0
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 0.25, 'balanced_accuracy': 0.25, 'f1_score': 0.05714285714285715, 'precision': 0.14285714285714285, 'recall': 0.03571428571428571, 'f1_score_weighted': 0.4}), 'accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 0.25, 'std': 0.0, 'min': 0.25, 'max': 0.25, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 0.05714285714285715, 'std': 0.0, 'min': 0.05714285714285715, 'max': 0.05714285714285715, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 0.14285714285714285, 'std': 0.0, 'min': 0.14285714285714285, 'max': 0.14285714285714285, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 0.03571428571428571, 'std': 0.0, 'min': 0.03571428571428571, 'max': 0.03571428571428571, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 0.4, 'std': 0.0, 'min': 0.4, 'max': 0.4, 'min_index': 0, 'max_index': 0}})}
Generated images for split val: 20 samples.
task accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task balanced_accuracy: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task precision: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task recall: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)
task f1_score_weighted: 1.00 (std: 0.00, min: 1.00 at index 0, max: 1.000000 at index 0)

Node 1
{'val': NodeMetric([], {'samples': 0, 'steps': 0, 0: NodeMetric([], {'samples': 0, 'steps': 0, 'accuracy': 1.0, 'balanced_accuracy': 1.0, 'f1_score': 1.0, 'precision': 1.0, 'recall': 1.0, 'f1_score_weighted': 1.0}), 'accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'balanced_accuracy': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'precision': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'recall': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}, 'f1_score_weighted': {'mean': 1.0, 'std': 0.0, 'min': 1.0, 'max': 1.0, 'min_index': 0, 'max_index': 0}})}
[Server] Skipping test_metrics: adapters not being trained (train_adapters=False)
[Server] Skipping train_metrics: adapters not being trained (train_adapters=False)

Average time cost: 4608.38s.
std for best accurancy: nan
mean for best accurancy: nan
All done!
Wed Jan 21 11:55:30 AM UTC 2026
